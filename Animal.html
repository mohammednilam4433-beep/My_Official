<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üêæ Animal Keeping Permission - Registration</title>
  <style>
    body, html {
      margin:0; 
      padding:0; 
      font-family: Arial, sans-serif;
    }

    /* Navbar */
    nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #2c3e50;
      padding: 12px 20px;
      color: white;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    /* Right section */
    .nav-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-right input {
      padding: 6px 10px;
      border: none;
      border-radius: 5px;
      font-size: 14px;
      outline: none;
    }

    .nav-right button {
      background: #ff6600;
      border: none;
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      color: white;
      font-size: 14px;
      transition: 0.3s;
    }

    .nav-right button:hover {
      background: #e65c00;
    }

    /* Page content overlay */
    body {
      background:url('https://images.unsplash.com/photo-1548761208-b7896a6ff225?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80') center/cover no-repeat;
      overflow-y:auto;
	  color: lighter;
    }

    .overlay {
      background:rgba(255,255,255,0.95);
      padding:40px;
      margin:80px auto 20px;
      max-width:1000px;
      border-radius:12px;
      box-shadow: 0 5px 25px rgba(0,0,0,0.2);
    }
    
    h1 {text-align:right; margin-top:0; font-size:32px;}
    h2 {margin-top:24px; font-size:20px; color:#00695c;}
    p {line-height:1.6;}

    /* Form */
    form {display:grid; gap:12px; margin-top:12px;}
    form input, form textarea, form select {padding:10px; border:1px solid #ccc; border-radius:8px;}
    form button {padding:12px; background:#00695c; color:white; border:none; border-radius:8px; cursor:pointer;}
    form button:hover {background:#004d40;}

    /* Contact Section */
    .contact-section {
      margin: 40px 0;
      padding: 20px;
      background-color: #f5f5f5;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .contact-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .contact-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      text-align: center;
    }
    
    .contact-card h3 {
      color: #004d99;
      margin-top: 0;
    }
    
    .contact-icon {
      font-size: 24px;
      margin-bottom: 10px;
      color: #ff6600;
    }

    /* Registration Form Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5);
    }
    
    .modal-content {
      background-color: #fefefe;
      margin: 5% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 800px;
      border-radius: 10px;
      position: relative;
    }
    
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    
    .close:hover {
      color: black;
    }
    
    .registration-form-container {
      max-width: 800px;
      margin: 20px auto;
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }
    
    .registration-form-container h2 {
      text-align: center;
      color: #333;
    }
    
    .registration-form-container label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #444;
    }
    
    .registration-form-container input, 
    .registration-form-container select, 
    .registration-form-container textarea {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }
    
    .registration-form-container textarea {
      resize: vertical;
    }
    
    .submit-btn {
      width: 100%;
      background: #007bff;
      color: #fff;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      margin-top: 20px;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .submit-btn:hover {
      background: #0056b3;
    }
    
    .error {
      color: red;
      font-size: 13px;
    }
    
    /* Registration Button */
    .registration-btn {
      display: block;
      width: 200px;
      margin: 30px auto;
      padding: 12px 20px;
      background: #ff6600;
      color: white;
      text-align: center;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .registration-btn:hover {
      background: #e65c00;
      transform: scale(1.05);
    }
    
    /* Footer */
    footer {
      text-align: center;
      padding: 20px;
      margin-top: 40px;
      background: #004d99;
      color: white;
      border-radius: 0 0 10px 10px;
    }
    
    .footer-content {
      max-width: 1000px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .footer-nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 15px;
    }
    
    .footer-nav a {
      color: white;
      text-decoration: none;
    }
    
    .footer-nav a:hover {
      text-decoration: underline;
    }
    
    /* Animal Selection */
    .animal-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    
    .animal-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }
    
    .animal-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .animal-card.selected {
      border-color: #007bff;
      background-color: #f0f8ff;
    }
    
    .animal-card h3 {
      margin-top: 0;
      color: #004d99;
    }
    
    .animal-icon {
      font-size: 40px;
      margin-bottom: 10px;
    }
    
    .step-indicator {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    
    .step {
      flex: 1;
      text-align: center;
      padding: 10px;
      background-color: #e9ecef;
      border-radius: 5px;
      margin: 0 5px;
    }
    
    .step.active {
      background-color: #007bff;
      color: white;
    }
    
    .form-step {
      display: none;
    }
    
    .form-step.active {
      display: block;
    }
    
    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    
    .nav-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    
    .prev-btn {
      background-color: #6c757d;
      color: white;
    }
    
    .next-btn {
      background-color: #007bff;
      color: white;
    }

    .success-message {
      display: none;
      background: #d4edda;
      color: #155724;
      padding: 15px;
      border-radius: 5px;
      margin: 20px 0;
      text-align: center;
    }

    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }

    .loading-spinner {
      border: 5px solid #f3f3f3;
      border-top: 5px solid #007bff;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Office Contact Information */
    .office-contact {
      margin: 20px 0;
      padding: 15px;
      background-color: #e8f4fd;
      border-radius: 8px;
      border-left: 4px solid #007bff;
    }
    
    .office-contact h3 {
      margin-top: 0;
      color: #004d99;
    }
    
    .office-contact p {
      margin: 8px 0;
    }
    
    .contact-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .contact-info-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .contact-info-icon {
      font-size: 20px;
      color: #007bff;
    }
    
    /* Document Requirements */
    .document-list {
      margin: 20px 0;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 8px;
      border-left: 4px solid #00695c;
    }
    
    .document-list ul {
      padding-left: 20px;
    }
    
    .document-list li {
      margin-bottom: 10px;
    }
    
    /* Animal Details */
    .animal-details {
      background: #e8f4fd;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border-left: 4px solid #007bff;
    }
    
    .animal-details h4 {
      margin-top: 0;
      color: #004d99;
    }
    
    .animal-number-input {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    
    .animal-number-input button {
      background: #007bff;
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      cursor: pointer;
    }
    
    .animal-number-input input {
      width: 60px;
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- Navigation Bar -->
  <nav>
    <h1>üêæ Animal Keeping Permission</h1>
    <div class="nav-right">
      <button onclick="goBack()">Back</button>
      <input type="text" id="searchBox" placeholder="Search...">
    </div> 
  </nav>

  <div class="overlay">
    <section id="regulations">
      <h2>Animal Keeping Permission Process</h2>
      <p>To keep animals at your residence in Sri Lanka, you must obtain permission from your local Pradeshiya Sabha. The process ensures that animals are kept in a manner that doesn't disturb neighbors or create public health issues.</p>
      
      <h2>Registration Process</h2>
      <p>There are two ways to register for animal keeping permission:</p>
      <ol>
        <li><strong>In-person registration:</strong> Visit your Pradeshiya Sabha office with the required documents</li>
        <li><strong>Online registration:</strong> Complete the online form which will be processed by your local Pradeshiya Sabha</li>
      </ol>
      
      <div class="document-list">
        <h3>Required Documents for Animal Keeping Permission</h3>
        <ul>
          <li>Completed application form (available at Pradeshiya Sabha or downloadable online)</li>
          <li>Copy of National Identity Card (NIC)</li>
          <li>Proof of residence (utility bill, deed, or rental agreement)</li>
          <li>Land ownership documents or landlord's consent letter</li>
          <li>Site plan showing animal shelter location and distance from neighboring properties</li>
          <li>Veterinary health certificates for the animals (if applicable)</li>
          <li>Photographs of the animal shelter facilities</li>
          <li>Neighborhood consent letter (for certain animals or quantities)</li>
        </ul>
      </div>
      
      <h2>Important Regulations</h2>
      <ul>
        <li>Permission is required for keeping more than 30 Hens</li>
        <li>Farm animals (poultry, goats, etc.) require special permission in residential areas</li>
        <li>Animals must be properly vaccinated and registered with a veterinarian</li>
        <li>Animal shelters must be maintained in hygienic conditions</li>
        <li>Noise and odor must not disturb neighbors</li>
        <li>Animals must be properly confined to your property</li>
        <li>Permission may be revoked if complaints are received and verified</li>
      </ul>
      
      <h2>Processing Time and Fees</h2>
      <ul>
        <li>Standard processing time: 7-14 working days</li>
        <li>Application fee: LKR..... (varies by Pradeshiya Sabha)</li>
        <li>Annual renewal may be required for certain animals</li>
        <li>Inspections may be conducted before approval</li>
      </ul>
    </section>
    
    <!-- Office Contact Information Section -->
    <section class="contact-section">
      <h2>Find Local Pradeshiya Sabha Contact Information</h2>
      <p>Select your district and pradeshiya sabha to view the local office contact details.</p>
      
      <div class="office-contact-selector">
        <label for="districtContact">Select District:</label>
        <select id="districtContact" name="districtContact" onchange="loadPradeshiyaSabhasContact()">
          <option value="">-- Select District --</option>
          <!-- Options will be loaded from database -->
        </select>
        
        <label for="pradeshiyaSabhaContact">Select Pradeshiya Sabha:</label>
        <select id="pradeshiyaSabhaContact" name="pradeshiyaSabhaContact" onchange="showOfficeContact()">
          <option value="">-- Select Pradeshiya Sabha --</option>
          <!-- Options will be loaded dynamically -->
        </select>
      </div>
      
      <div id="officeContactInfo" class="office-contact" style="display: none;">
        <h3>Pradeshiya Sabha Contact Information</h3>
        <div class="contact-info-grid">
          <div class="contact-info-item">
            <span class="contact-info-icon">üìû</span>
            <div>
              <strong>Phone:</strong>
              <p id="officePhone"></p>
            </div>
          </div>
          <div class="contact-info-item">
            <span class="contact-info-icon">üìß</span>
            <div>
              <strong>Email:</strong>
              <p id="officeEmail"></p>
            </div>
          </div>
          <div class="contact-info-item">
            <span class="contact-info-icon">üïí</span>
            <div>
              <strong>Working Hours:</strong>
              <p id="officeHours"></p>
            </div>
          </div>
          <div class="contact-info-item">
            <span class="contact-info-icon">üìç</span>
            <div>
              <strong>Address:</strong>
              <p id="officeAddress"></p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

    <!-- Animal Registration Button -->
    <div class="registration-btn" id="openRegistrationForm">
      Online Registration Form
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
      <h3>‚úÖ Registration Submitted Successfully!</h3>
      <p>Your animal keeping permission application has been sent to the Pradeshiya Sabha. You will receive a confirmation email shortly.</p>
      <p><strong>Application Reference Number: <span id="referenceNumber"></span></strong></p>
    </div>

    <!-- Loading Indicator -->
    <div class="loading" id="loadingIndicator">
      <div class="loading-spinner"></div>
      <p>Processing your request...</p>
    </div>

    <!-- Animal Registration Form Modal -->
    <div id="registrationModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <div class="registration-form-container">
          <h2>Animal Keeping Permission Registration</h2>
          
          <div class="step-indicator">
            <div class="step active" id="step1-indicator">1. Personal Details</div>
            <div class="step" id="step2-indicator">2. Location</div>
            <div class="step" id="step3-indicator">3. Animal Details</div>
            <div class="step" id="step4-indicator">4. Confirmation</div>
          </div>
          
          <form id="registrationForm">
            <!-- Step 1: Personal Details -->
            <div class="form-step active" id="step1">
              <label>Full Name *</label>
              <input type="text" id="name" name="name" required>
              <div id="nameError" class="error"></div>

              <label>Contact Number *</label>
              <input type="tel" id="phone" name="phone" required>
              <div id="phoneError" class="error"></div>

              <label>Email Address *</label>
              <input type="email" id="email" name="email" required>
              <div id="emailError" class="error"></div>

              <label>NIC Number *</label>
              <input type="text" id="nic" name="nic" required>
              <div id="nicError" class="error"></div>

              <label>Residential Address *</label>
              <textarea id="address" name="address" rows="3" required></textarea>
              
              <div class="navigation-buttons">
                <div></div> <!-- Empty div for spacing -->
                <button type="button" class="nav-btn next-btn" onclick="nextStep(1)">Next</button>
              </div>
            </div>
            
            <!-- Step 2: Location Selection -->
            <div class="form-step" id="step2">
              <label>Select District *</label>
              <select id="district" name="district" required onchange="loadPradeshiyaSabhas()">
                <option value="">-- Select District --</option>
                <!-- Options will be loaded from database -->
              </select>
              
              <label>Select Pradeshiya Sabha *</label>
              <select id="pradeshiyaSabha" name="pradeshiyaSabha" required onchange="loadVillages()">
                <option value="">-- Select Pradeshiya Sabha --</option>
                <!-- Options will be loaded dynamically -->
              </select>
              
              <label>Select Village *</label>
              <select id="village" name="village" required>
                <option value="">-- Select Village --</option>
                <!-- Options will be loaded dynamically -->
              </select>
              
              <div class="navigation-buttons">
                <button type="button" class="nav-btn prev-btn" onclick="prevStep(2)">Previous</button>
                <button type="button" class="nav-btn next-btn" onclick="nextStep(2)">Next</button>
              </div>
            </div>
            
            <!-- Step 3: Animal Selection -->
            <div class="form-step" id="step3">
              <h3>Select Animals You Wish to Keep</h3>
              <p>Please select the type and number of animals you want to register:</p>
              
              <div id="animalSelection" class="animal-grid">
                <!-- Animal cards will be loaded here -->
              </div>
              
              <div id="selectedAnimals" class="animal-details" style="display: none;">
                <h4>Selected Animals</h4>
                <div id="animalList"></div>
              </div>
              
              <div class="navigation-buttons">
                <button type="button" class="nav-btn prev-btn" onclick="prevStep(3)">Previous</button>
                <button type="button" class="nav-btn next-btn" onclick="nextStep(3)">Next</button>
              </div>
            </div>
            
            <!-- Step 4: Confirmation -->
            <div class="form-step" id="step4">
              <h3>Please review your information:</h3>
              <div id="reviewDetails"></div>
              
              <label>
                <input type="checkbox" id="confirmResidence" required>
                I confirm that I am the owner/occupier of the residence where animals will be kept.
              </label>
              
              <label>
                <input type="checkbox" id="confirmRegulations" required>
                I agree to comply with all animal keeping regulations and maintain proper hygiene.
              </label>
              
              <label>
                <input type="checkbox" id="confirmDetails" required>
                I confirm that all the information provided is true and accurate.
              </label>
              
              <div class="navigation-buttons">
                <button type="button" class="nav-btn prev-btn" onclick="prevStep(4)">Previous</button>
                <button type="submit" class="submit-btn">Submit Registration</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Contact Section -->
    <section class="contact-section">
      <h2>Department of Animal Production & Health Contact Information</h2>
      <div class="contact-grid">
        <div class="contact-card">
          <div class="contact-icon">üìû</div>
          <h3>Phone</h3>
          <p>+94 011 256 3388</p>
          <p>+94 011 256 3389</p>
        </div>
        
        <div class="contact-card">
          <div class="contact-icon">üìß</div>
          <h3>Email</h3>
          <p>animal.health@daph.gov.lk</p>
          <p>permits@daph.gov.lk</p>
        </div>
        
        <div class="contact-card">
          <div class="contact-icon">üìç</div>
          <h3>Location</h3>
          <p>Department of Animal Production & Health</p>
          <p>Getambe, Peradeniya, Sri Lanka</p>
        </div>
        
        <div class="contact-card">
          <div class="contact-icon">üïí</div>
          <h3>Working Hours</h3>
          <p>Monday-Friday: 8:30 AM - 4:30 PM</p>
          <p>Saturday: 9:00 AM - 1:00 PM</p>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="footer-content">
        <div class="footer-nav">
          <a href="index1.html">Home</a>
          <a href="#">About Us</a>
          <a href="#">Services</a>
          <a href="#">Contact</a>
          <a href="#">Privacy Policy</a>
        </div>
        <p>&copy; 2025 Animal Keeping Permission | Department of Animal Production & Health</p>
      </div>
    </footer>
  </div>

  <script>
    // Database simulation (in a real application, this would be server-side)
    const districtsData = [
      "Ampara", "Anuradhapura", "Badulla", "Batticaloa", "Colombo", 
      "Galle", "Gampaha", "Hambantota", "Jaffna", "Kalutara",
      "Kandy", "Kegalle", "Kilinochchi", "Kurunegala", "Mannar",
      "Matale", "Matara", "Monaragala", "Mullaitivu", "Nuwara Eliya",
      "Polonnaruwa", "Puttalam", "Ratnapura", "Trincomalee", "Vavuniya"
    ];

    const pradeshiyaSabhasData = {
      "Kilinochchi": ["Poonakary", "Karachchi","Pachchilaippalli"],
      "Jaffna": ["Jaffna","Kayts","Delft","Karainagar","Chavakachcheri","Point Pedro","Nallur", "Valikamam East","Valikamam North","Valikamam West","Valikamam South","Valikamam South West","Thenmaradchi", "Vadamaradchi South West","Velanai"],
      "Colombo": ["Homagama","Kotikawatta Mulleriyawa","Seethawaka"],
      "Gampaha": ["Attanagalla","Biyagama","Divulapitiya","Dompe","Gampaha","Ja-ela","Katana","Kelaniya","Mahara","Meerigama","Minuwangoda","Wattala"],
      "Kandy": ["Akurana","Ganga lhala","Harispattuwa","Kandy Gravets & Gangawata Korale","Kundasale","Meda Dumbara","Minipe","Panwila","Pasbage Korale","Patadumbara","Patahewahta","Pujapitiya","Thumpane","Uda Palatha","Ududumbara","Udunuwara","Yatinuwara","Delthota","Doluwa","Hatharaliyadda"],
	  "Ampara": ["Dehiyattakandiya", "Damana", "Uhana","Mahaoya","Namaloya","Padiyatalawa","Sammanthurai","Akkaraipattu","Ampara","Potuvil","Addalachchnai","Alayadivembu","Lahugala","Nindavur","Thirukkovil","Karaithivu","Navithanveli","Irrakkaram"],
	  "Anuradhapura": ["Galenbindunuwewa","Galnewa","Horowpathana","Ipalogama","Kahatagasdigiliya","Kebathigollawa","Kekirawa","Medawachchiya","Mihintale","Nochchiyagama","Nuwaragam Palatha (East)","Nuwaragam Palatha (Central)","Padaviya","Palagala","Rajanganaya","Rambewa","Thalawa","Thirappane"],
	  "Badulla": ["Badulla","Bandarawela","Ella","Haldummulla","Hali-Ela","Haputale","Kandeketiya","Lunugala","Mahiyanganaya","Meegahakiula","Passara","Rideemaliyadda","Soranatota","Uva Paranagama","Welimada"],
	  "Batticaloa": ["Eravurpattu","Koralaipattu","Koralaipattu West","Koralaipattu North","Manmunai South Eravurpattu","Manmunai","Manmunai West","Manmunai South West","Porativupattu"],
	  "Galle": ["Akmeemana","Ambalangoda","Baddegama","Balapitiya","Bentota","Bope-Poddala","Elpitiya","Habaraduwa","Imaduwa","Karandeniya","Nagoda","Neluwa","Niyagama","Raggama","Thawalama","Welivitiya-Divithura","Yakkalamulla"],
	  "Monaragala": ["Badalkumbara","Bibila","Buttala","Kataragama","Madulla","Medagama","Moneragala","Siyambalanduwa","Thanamalwila","Wellawaya"],
	  "Hambantota": ["Ambalantota","Angunakolapelassa","Beliatta","Hambantota","Katuwana","Lunugamvehera","Sooriyawewa","Tangalle","Tissamaharama","Weeraketiya"],
	  "Kalutara": ["Agalawatta","Bandaragama","Beruwela","Bulathsinhala","Dodangoda","Horana","Kalutara","Madurawela","Matugama","Palindanuwara","Panadura","Walallawita"],
	  "Kegalle": ["Aranayake","Bulathkohupitiya","Dehiowita","Deraniyagala","Galigamuwa","Kegalle","Mawanella","Rambukkana","Ruwanwella","Warakapola","Yatiyantota"],
	  "Kurunegala": ["Alawwa","Bingiriya","Galgamuwa","Giribawa","lbbagamuwa","Kpbeiagane","Kuliyapitiya","Kurunegala","Mahawa","Mawathagama","Narammala","Nikaweratiya","Panduwasnuwara","Pannala","Polgahawela","Polpithigama","Ridigama","Udubaddawa","Wariyapola"],
	  "Mannar": ["Mannar","Manthai West","Musali","Nanaddan"],
	  "Matale": ["Ambanganga Korale","Dambulla","Galewala","Laggala-Pallegama","Matale","Naula","Pallepola","Rattota","Ukuwela","Wilgamuwa","Yatawatta","Yatawatta"],
	  "Matara": ["Akuressa","Athuraliya","Devinuwara","Dickwella","Hakmana","Kamburupitiya","Kirinda-Puhulwella","Kotapola","Malimbada","Matara","Mulatiyana","Pasgoda","Pitabeddara","Thihagoda","Weligama"],
	  "Mullaitivu": ["Manthai East","Maritimepattu","Puthukudiyiruppu","Thunukkai"],
	  "Nuwara Eliya": ["Ambagamuwa","Hanguranketha","Kothmale","Nuwara Eliya","Walapane"],
	  "Polonnaruwa": ["Dimbulagala","Elahera","Hingurakgoda","Lankapura","Medirigiriya","Polonnaruwa","Welikanda"],
	  "Puttalam": ["Anamaduwa","Arachchikattuwa","Chilaw","Kalpitiya","Karuwalagaswewa","Nattandiya","Nawagattegama","Puttalam","Wanathawilluwa","Wennappuwa"],
	  "Ratnapura": ["Ayagama","Balangoda","Ehaliyagoda","Embilipitiya","Godakawela","Imbulpe","Kahawatta","Kalawana","Kolonna","Kuruwita","Nivithigala","Pelmadulla","Rathnapura","Weligepola"],
	  "Trincomalee": ["Trincomalee Town & Gravets", "Kuchchaveli", "Thampalakamam","Muttur","Kinniya","Verugal","Seruvila","Kantalai","Morawewa","Gomarankadawala","Padavisripura"],
	  "Vavuniya": ["Vavuniya North","Vavuniya South Tamil","Vavuniya South Sinhala","Vengalacheddikulam"],
    };

    // Village data
    const villagesData = {
      "Poonakary": ["Village 1", "Village 2", "Village 3"],
      "Karachchi": ["Village A", "Village B", "Village C"],
      "Jaffna": ["Village X", "Village Y", "Village Z"],
      // Add more villages for other pradeshiya sabhas
    };

    // Animal data
    const animalsData = [
      { id: 1, name: "Dog", icon: "üêï", maxAllowed: 1, requiresSpecialPermit: false },
      { id: 2, name: "Chicken", icon: "üêî", maxAllowed: 100, requiresSpecialPermit: true },
      { id: 3, name: "Duck", icon: "ü¶Ü", maxAllowed: 100, requiresSpecialPermit: true },
      { id: 4, name: "Goat", icon: "üêê", maxAllowed: 1, requiresSpecialPermit: true },
      { id: 5, name: "Sheep", icon: "üêë", maxAllowed: 1, requiresSpecialPermit: true },
      { id: 6, name: "Cow", icon: "üêÑ", maxAllowed: 1, requiresSpecialPermit: true },
      { id: 7, name: "Rabbit", icon: "üêá", maxAllowed: 10, requiresSpecialPermit: false },
      { id: 8, name: "Pigeon", icon: "üê¶", maxAllowed: 20, requiresSpecialPermit: false },
	  { id: 9, name: "Pig", icon: "", maxAllowed: 5, requiresSpecialPermit: true },
      { id: 10, name: "Other", icon: "üêæ", maxAllowed: 5, requiresSpecialPermit: true }
    ];

    // Office contact information data
    const officeContactData = {
      "Poonakary": {
        phone: "+94 021 123 4567",
        email: "poonakary.ps@animal.gov.lk",
        hours: "Monday-Friday: 8:30 AM - 4:30 PM",
        address: "123 Main Street, Poonakary, Kilinochchi"
      },
      "Karachchi": {
        phone: "+94 021 123 4568",
        email: "karachchi.ps@animal.gov.lk",
        hours: "Monday-Friday: 8:30 AM - 4:30 PM, Saturday: 9:00 AM - 1:00 PM",
        address: "456 Central Road, Karachchi, Kilinochchi"
      },
      "Jaffna": {
        phone: "+94 021 123 4569",
        email: "jaffna.ps@animal.gov.lk",
        hours: "Monday-Friday: 8:30 AM - 4:30 PM",
        address: "789 Temple Road, Jaffna"
      },
      "Colombo": {
        phone: "+94 011 123 4567",
        email: "colombo.ps@animal.gov.lk",
        hours: "Monday-Friday: 8:30 AM - 4:30 PM, Saturday: 9:00 AM - 1:00 PM",
        address: "123 Galle Road, Colombo 03"
      },
      "Gampaha": {
        phone: "+94 033 123 4567",
        email: "gampaha.ps@animal.gov.lk",
        hours: "Monday-Friday: 8:30 AM - 4:30 PM",
        address: "45 Negombo Road, Gampaha"
      },
      "Kandy": {
        phone: "+94 081 123 4567",
        email: "kandy.ps@animal.gov.lk",
        hours: "Monday-Friday: 8:30 AM - 4:30 PM, Saturday: 9:00 AM - 1:00 PM",
        address: "78 Temple Street, Kandy"
      },
      // Add more office contact information for other pradeshiya sabhas
    };

    let selectedAnimals = {};
    let currentStep = 1;

    function goBack() {
      window.history.back();
    }

    // Search action
    document.getElementById("searchBox").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        alert("You searched for: " + this.value);
      }
    });
    
    // Modal functionality
    const modal = document.getElementById("registrationModal");
    const btn = document.getElementById("openRegistrationForm");
    const span = document.getElementsByClassName("close")[0];
    
    btn.onclick = function() {
      modal.style.display = "block";
      resetForm();
      loadDistricts(); // Load districts when modal opens
      loadAnimals(); // Load animals when modal opens
    }
    
    span.onclick = function() {
      modal.style.display = "none";
    }
    
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }
    
    function resetForm() {
      currentStep = 1;
      selectedAnimals = {};
      updateStepIndicator();
      document.getElementById("registrationForm").reset();
      document.getElementById("pradeshiyaSabha").innerHTML = '<option value="">-- Select Pradeshiya Sabha --</option>';
      document.getElementById("village").innerHTML = '<option value="">-- Select Village --</option>';
      document.getElementById("selectedAnimals").style.display = "none";
      document.getElementById("animalList").innerHTML = "";
    }
    
    function updateStepIndicator() {
      // Update step indicators
      for (let i = 1; i <= 4; i++) {
        const indicator = document.getElementById(`step${i}-indicator`);
        const step = document.getElementById(`step${i}`);
        
        if (i === currentStep) {
          indicator.classList.add("active");
          step.classList.add("active");
        } else {
          indicator.classList.remove("active");
          step.classList.remove("active");
        }
      }
    }
    
    function nextStep(step) {
      // Validate current step before proceeding
      if (step === 1 && !validateStep1()) return;
      if (step === 2 && !validateStep2()) return;
      if (step === 3 && !validateStep3()) return;
      
      currentStep = step + 1;
      
      // If moving to step 4, show review
      if (currentStep === 4) {
        showReview();
      }
      
      updateStepIndicator();
    }
    
    function prevStep(step) {
      currentStep = step - 1;
      updateStepIndicator();
    }
    
    function validateStep1() {
      let valid = true;

      // Name validation
      const name = document.getElementById("name").value.trim();
      if(name.length < 3){
        document.getElementById("nameError").innerText = "Name must be at least 3 characters.";
        valid = false;
      } else {
        document.getElementById("nameError").innerText = "";
      }

      // Phone validation
      const phone = document.getElementById("phone").value.trim();
      const phonePattern = /^[0-9]{10}$/;
      if(!phonePattern.test(phone)){
        document.getElementById("phoneError").innerText = "Enter a valid 10-digit number.";
        valid = false;
      } else {
        document.getElementById("phoneError").innerText = "";
      }

      // Email validation
      const email = document.getElementById("email").value.trim();
      const emailPattern = /^[^ ]+@[^ ]+\.[a-z]{2,3}$/;
      if(!emailPattern.test(email)){
        document.getElementById("emailError").innerText = "Enter a valid email address.";
        valid = false;
      } else {
        document.getElementById("emailError").innerText = "";
      }
      
      // NIC validation
      const nic = document.getElementById("nic").value.trim();
      const nicPattern = /^[0-9]{9}[vVxX]?$|^[0-9]{12}$/;
      if(!nicPattern.test(nic)){
        document.getElementById("nicError").innerText = "Enter a valid NIC number.";
        valid = false;
      } else {
        document.getElementById("nicError").innerText = "";
      }

      return valid;
    }
    
    function validateStep2() {
      const district = document.getElementById("district").value;
      const pradeshiyaSabha = document.getElementById("pradeshiyaSabha").value;
      const village = document.getElementById("village").value;
      
      if (!district) {
        alert("Please select a district.");
        return false;
      }
      
      if (!pradeshiyaSabha) {
        alert("Please select a pradeshiya sabha.");
        return false;
      }
      
      if (!village) {
        alert("Please select a village.");
        return false;
      }
      
      return true;
    }
    
    function validateStep3() {
      if (Object.keys(selectedAnimals).length === 0) {
        alert("Please select at least one animal.");
        return false;
      }
      
      return true;
    }
    
    function loadDistricts() {
      const districtSelect = document.getElementById("district");
      
      // Clear previous options
      districtSelect.innerHTML = '<option value="">-- Select District --</option>';
      
      // Add all 25 districts
      districtsData.forEach(district => {
        const option = document.createElement("option");
        option.value = district;
        option.textContent = district;
        districtSelect.appendChild(option);
      });
    }
    
    function loadPradeshiyaSabhas() {
      const district = document.getElementById("district").value;
      const pradeshiyaSabhaSelect = document.getElementById("pradeshiyaSabha");
      
      // Clear previous options
      pradeshiyaSabhaSelect.innerHTML = '<option value="">-- Select Pradeshiya Sabha --</option>';
      
      if (district && pradeshiyaSabhasData[district]) {
        pradeshiyaSabhasData[district].forEach(sabha => {
          const option = document.createElement("option");
          option.value = sabha;
          option.textContent = sabha;
          pradeshiyaSabhaSelect.appendChild(option);
        });
      } else {
        // If district not in our data, show a generic option
        const option = document.createElement("option");
        option.value = "other";
        option.textContent = "Other (Please specify)";
        pradeshiyaSabhaSelect.appendChild(option);
      }
      
      // Reset village selection
      document.getElementById("village").innerHTML = '<option value="">-- Select Village --</option>';
    }
    
    function loadVillages() {
      const pradeshiyaSabha = document.getElementById("pradeshiyaSabha").value;
      const villageSelect = document.getElementById("village");
      
      // Clear previous options
      villageSelect.innerHTML = '<option value="">-- Select Village --</option>';
      
      if (!pradeshiyaSabha) {
        return;
      }
      
      const villages = villagesData[pradeshiyaSabha] || [];
      
      if (villages.length === 0) {
        // If no specific villages for this pradeshiya sabha, show generic options
        const option = document.createElement("option");
        option.value = "other";
        option.textContent = "Other (Please specify)";
        villageSelect.appendChild(option);
        return;
      }
      
      villages.forEach(village => {
        const option = document.createElement("option");
        option.value = village;
        option.textContent = village;
        villageSelect.appendChild(option);
      });
    }
    
    function loadAnimals() {
      const animalSelection = document.getElementById("animalSelection");
      let html = '';
      
      animalsData.forEach(animal => {
        html += `
          <div class="animal-card" onclick="selectAnimal(${animal.id})" id="animal-${animal.id}">
            <div class="animal-icon">${animal.icon}</div>
            <h3>${animal.name}</h3>
            <p>Max: ${animal.maxAllowed}</p>
            ${animal.requiresSpecialPermit ? '<p><small>Special Permit Required</small></p>' : ''}
          </div>
        `;
      });
      
      animalSelection.innerHTML = html;
    }
    
    function selectAnimal(id) {
      const animal = animalsData.find(a => a.id === id);
      
      // Show number input for this animal
      const animalCard = document.getElementById(`animal-${id}`);
      if (animalCard.classList.contains('selected')) {
        // If already selected, remove it
        animalCard.classList.remove('selected');
        delete selectedAnimals[id];
      } else {
        // If not selected, add it
        animalCard.classList.add('selected');
        
        // Create number input for this animal
        const numberInputId = `animal-count-${id}`;
        let numberInputHtml = `
          <div class="animal-number-input">
            <button type="button" onclick="decreaseAnimalCount(${id})">-</button>
            <input type="number" id="${numberInputId}" name="${numberInputId}" value="1" min="1" max="${animal.maxAllowed}" onchange="updateAnimalCount(${id})">
            <button type="button" onclick="increaseAnimalCount(${id})">+</button>
            <span>${animal.name} ${animal.icon}</span>
          </div>
        `;
        
        // Add to selected animals list
        document.getElementById("animalList").innerHTML += numberInputHtml;
        selectedAnimals[id] = {
          animal: animal,
          count: 1
        };
      }
      
      // Show/hide selected animals section
      if (Object.keys(selectedAnimals).length > 0) {
        document.getElementById("selectedAnimals").style.display = "block";
      } else {
        document.getElementById("selectedAnimals").style.display = "none";
      }
    }
    
    function increaseAnimalCount(id) {
      const input = document.getElementById(`animal-count-${id}`);
      const max = animalsData.find(a => a.id === id).maxAllowed;
      if (parseInt(input.value) < max) {
        input.value = parseInt(input.value) + 1;
        updateAnimalCount(id);
      }
    }
    
    function decreaseAnimalCount(id) {
      const input = document.getElementById(`animal-count-${id}`);
      if (parseInt(input.value) > 1) {
        input.value = parseInt(input.value) - 1;
        updateAnimalCount(id);
      }
    }
    
    function updateAnimalCount(id) {
      const input = document.getElementById(`animal-count-${id}`);
      selectedAnimals[id].count = parseInt(input.value);
    }
    
    function showReview() {
      const name = document.getElementById("name").value;
      const phone = document.getElementById("phone").value;
      const email = document.getElementById("email").value;
      const nic = document.getElementById("nic").value;
      const address = document.getElementById("address").value;
      const district = document.getElementById("district").value;
      const pradeshiyaSabha = document.getElementById("pradeshiyaSabha").value;
      const village = document.getElementById("village").value;
      
      let html = `
        <p><strong>Name:</strong> ${name}</p>
        <p><strong>Phone:</strong> ${phone}</p>
        <p><strong>Email:</strong> ${email}</p>
        <p><strong>NIC:</strong> ${nic}</p>
        <p><strong>Address:</strong> ${address}</p>
        <p><strong>District:</strong> ${district}</p>
        <p><strong>Pradeshiya Sabha:</strong> ${pradeshiyaSabha}</p>
        <p><strong>Village:</strong> ${village}</p>
        <p><strong>Selected Animals:</strong></p>
        <ul>
      `;
      
      for (const id in selectedAnimals) {
        const animalData = selectedAnimals[id];
        html += `<li>${animalData.animal.icon} ${animalData.animal.name}: ${animalData.count}</li>`;
      }
      
      html += `</ul>`;
      
      document.getElementById("reviewDetails").innerHTML = html;
    }
    
    // Form submission
    document.getElementById("registrationForm").addEventListener("submit", async function(event){
      event.preventDefault();
      
      if (!validateStep1() || !validateStep2() || !validateStep3()) {
        alert("Please fix the errors in the form.");
        return;
      }
      
      // Show loading indicator
      document.getElementById("loadingIndicator").style.display = "block";
      modal.style.display = "none";
      
      // Collect form data
      const formData = {
        name: document.getElementById("name").value,
        phone: document.getElementById("phone").value,
        email: document.getElementById("email").value,
        nic: document.getElementById("nic").value,
        address: document.getElementById("address").value,
        district: document.getElementById("district").value,
        pradeshiyaSabha: document.getElementById("pradeshiyaSabha").value,
        village: document.getElementById("village").value,
        animals: selectedAnimals
      };
      
      try {
        // In a real application, you would send this data to your server
        // Simulate API call with timeout
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // Save to database (simulated)
        console.log("Saving to database:", formData);
        
        // Generate reference number
        const referenceNumber = "AKP" + Date.now().toString().substr(-6);
        document.getElementById("referenceNumber").textContent = referenceNumber;
        
        // Simulate sending email to Pradeshiya Sabha
        console.log(`Sending registration to Pradeshiya Sabha: ${formData.pradeshiyaSabha}`);
        console.log(`Registration request from: ${formData.name} (${formData.email})`);
        console.log(`Animals:`, formData.animals);
        
        // Simulate sending data to Animal Production Department
        console.log(`Sending registration details to Animal Production Department`);
        
        // Hide loading indicator
        document.getElementById("loadingIndicator").style.display = "none";
        
        // Show success message
        document.getElementById("successMessage").style.display = "block";
        
        // Reset form
        resetForm();
        
        // In a real application, you would use code like this to send to your backend:
        /*
        const response = await fetch('/api/register-animal', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });
        
        if (response.ok) {
          const result = await response.json();
          document.getElementById("loadingIndicator").style.display = "none";
          document.getElementById("successMessage").style.display = "block";
          document.getElementById("referenceNumber").textContent = result.referenceNumber;
          resetForm();
        } else {
          throw new Error('Failed to submit registration');
        }
        */
        
      } catch (error) {
        console.error("Error:", error);
        document.getElementById("loadingIndicator").style.display = "none";
        alert("There was an error submitting your registration. Please try again.");
      }
    });

    // Office contact information functions
    function loadDistrictsContact() {
      const districtSelect = document.getElementById("districtContact");
      
      // Clear previous options
      districtSelect.innerHTML = '<option value="">-- Select District --</option>';
      
      // Add all 25 districts
      districtsData.forEach(district => {
        const option = document.createElement("option");
        option.value = district;
        option.textContent = district;
        districtSelect.appendChild(option);
      });
    }
    
    function loadPradeshiyaSabhasContact() {
      const district = document.getElementById("districtContact").value;
      const pradeshiyaSabhaSelect = document.getElementById("pradeshiyaSabhaContact");
      
      // Clear previous options
      pradeshiyaSabhaSelect.innerHTML = '<option value="">-- Select Pradeshiya Sabha --</option>';
      
      if (district && pradeshiyaSabhasData[district]) {
        pradeshiyaSabhasData[district].forEach(sabha => {
          const option = document.createElement("option");
          option.value = sabha;
          option.textContent = sabha;
          pradeshiyaSabhaSelect.appendChild(option);
        });
      } else {
        // If district not in our data, show a generic option
        const option = document.createElement("option");
        option.value = "other";
        option.textContent = "Other (Please specify)";
        pradeshiyaSabhaSelect.appendChild(option);
      }
      
      // Hide office contact info when district changes
      document.getElementById("officeContactInfo").style.display = "none";
    }
    
    function showOfficeContact() {
      const pradeshiyaSabha = document.getElementById("pradeshiyaSabhaContact").value;
      const officeContactInfo = document.getElementById("officeContactInfo");
      
      if (!pradeshiyaSabha) {
        officeContactInfo.style.display = "none";
        return;
      }
      
      const contactInfo = officeContactData[pradeshiyaSabha];
      
      if (!contactInfo) {
        // If no specific contact info for this pradeshiya sabha, show generic info
        document.getElementById("officePhone").textContent = "+94 011 256 3388";
        document.getElementById("officeEmail").textContent = "animal.health@daph.gov.lk";
        document.getElementById("officeHours").textContent = "Monday-Friday: 8:30 AM - 4:30 PM";
        document.getElementById("officeAddress").textContent = "Please contact the head office for location details";
      } else {
        // Show specific contact info
        document.getElementById("officePhone").textContent = contactInfo.phone;
        document.getElementById("officeEmail").textContent = contactInfo.email;
        document.getElementById("officeHours").textContent = contactInfo.hours;
        document.getElementById("officeAddress").textContent = contactInfo.address;
      }
      
      officeContactInfo.style.display = "block";
    }

    // Initialize districts when page loads
    window.onload = function() {
      loadDistricts();
      loadDistrictsContact(); // Also load districts for contact section
    };
  </script>
</body>
</html>