<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeBridge Rural - Sri Lanka</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header Styles */
/* =========================================
   PREMIUM NAVIGATION BAR (Dropdown Enabled)
   ========================================= */

header {
    background-color: #ffffff;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); /* மென்மையான நிழல் */
    position: sticky;
    top: 0;
    z-index: 1000;
    padding: 0;
    height: 75px;
    display: flex;
    align-items: center;
    border-bottom: 1px solid #f0f0f0;
}

.header-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 90%;
    max-width: 1280px;
    margin: 0 auto;
}

/* --- LOGO --- */
.logo-container {
    display: flex;
    align-items: center;
    gap: 12px;
}

.logo {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(46, 139, 87, 0.2);
}

.logo img { width: 100%; height: 100%; object-fit: cover; }

.title {
    font-size: 22px;
    font-weight: 800;
    color: #1e293b;
    letter-spacing: -0.5px;
}
.title span { color: #2e8b57; }

/* --- NAVIGATION LINKS & DROPDOWN --- */
nav ul {
    display: flex;
    align-items: center;
    list-style: none;
    gap: 20px;
    margin: 0;
    padding: 0;
}

nav ul li { position: relative; }

/* Main Links Style */
nav ul li a {
    text-decoration: none;
    color: #475569;
    font-weight: 600;
    font-size: 15px;
    padding: 10px 0;
    transition: color 0.3s;
    display: flex;
    align-items: center;
    gap: 5px;
}

nav ul li a:hover { color: #2e8b57; }

/* DROPDOWN MENU DESIGN (The Magic Part) */
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    background: white;
    min-width: 240px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    border-radius: 12px;
    border: 1px solid #f1f5f9;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    padding: 8px;
    z-index: 999;
}

/* Show Dropdown on Hover */
nav ul li:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
}

/* Dropdown Items */
.dropdown-menu a {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    color: #334155;
    font-size: 14px;
    border-radius: 8px;
    white-space: nowrap;
}

.dropdown-menu a:hover {
    background-color: #f0fdf4; /* Light Green */
    color: #2e8b57;
}

.dropdown-menu i {
    width: 20px;
    margin-right: 10px;
    color: #94a3b8;
}

.dropdown-menu a:hover i { color: #2e8b57; }

/* --- RIGHT SIDE ACTIONS --- */
.user-actions {
    display: flex;
    align-items: center;
    gap: 15px;
}

/* Profile Pill */
.user-profile {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 5px 15px 5px 5px;
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 50px;
}

.user-avatar {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    overflow: hidden;
    border: 2px solid white;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.user-name {
    font-size: 14px;
    font-weight: 600;
    color: #334155;
}

/* Login Button */
.login-btn {
    background: linear-gradient(135deg, #2e8b57, #10b981);
    color: white;
    padding: 10px 24px;
    border-radius: 50px;
    font-size: 14px;
    font-weight: 600;
    text-decoration: none;
    box-shadow: 0 4px 10px rgba(46, 139, 87, 0.25);
    transition: transform 0.2s;
    cursor: pointer;
}

.login-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(46, 139, 87, 0.35);
}

/* Language Selector */
.lang-select {
    padding: 8px 12px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 500;
    color: #475569;
    cursor: pointer;
    background-color: white;
    outline: none;
}
.lang-select:focus { border-color: #2e8b57; }
        /* Auth Modals */
        .auth-modal, .provider-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .auth-container, .provider-container {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .provider-container {
            max-width: 600px;
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .auth-header h2 {
            color: #2e8b57;
            margin-bottom: 10px;
        }
        
        .auth-form .form-group {
            margin-bottom: 20px;
        }
        
        .auth-form label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .auth-form input, .auth-form select, .auth-form textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .auth-form input:focus, .auth-form select:focus, .auth-form textarea:focus {
            outline: none;
            border-color: #2e8b57;
        }
        
        .profile-picture-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .profile-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            overflow: hidden;
            margin-bottom: 10px;
            border: 3px solid #2e8b57;
        }
        
        .profile-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .auth-form button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(to right, #2e8b57, #3cb371);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .auth-form button:hover {
            background: linear-gradient(to right, #246a44, #2e8b57);
        }
        
        .auth-footer {
            text-align: center;
            margin-top: 20px;
        }
        
        .auth-footer a {
            color: #2e8b57;
            text-decoration: none;
            cursor: pointer;
        }
        
        .auth-footer a:hover {
            text-decoration: underline;
        }
        
/* Close Button - High Visibility Update */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: #ffe5e5; /* மென்மையான சிவப்பு பின்னணி */
            color: #d32f2f; /* அடர் சிவப்பு எழுத்து */
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 1px solid #ffcccc;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1000; /* எல்லாவற்றிற்கும் மேலே தெரியும் */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .close-btn:hover {
            background-color: #d32f2f; /* மவுஸ் வைத்தால் சிவப்பு நிறமாக மாறும் */
            color: white;
            transform: rotate(90deg); /* சிறிய சுழற்சி அனிமேஷன் */
        }
        
        /* Provider Selection */
        .provider-selection {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .provider-card {
            width: 180px;
            padding: 20px;
            text-align: center;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .provider-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .provider-icon {
            font-size: 2.5rem;
            color: #2e8b57;
            margin-bottom: 15px;
        }
        
        /* User Dashboard */
        .dashboard {
            display: none;
            padding: 40px 0;
        }
        
        .dashboard-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .dashboard-header h2 {
            color: #2e8b57;
            margin-bottom: 10px;
        }
        
        .user-forms-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .form-card {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .form-card h3 {
            color: #2e8b57;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #2e8b57;
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .submit-btn {
            padding: 12px 25px;
            background: linear-gradient(to right, #2e8b57, #3cb371);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .submit-btn:hover {
            background: linear-gradient(to right, #246a44, #2e8b57);
        }
        
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }
        
        .category-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .category-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.15);
        }
        
        .category-icon {
            height: 120px;
            background: linear-gradient(to right, #2e8b57, #ff7e00);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
        }
        
        .category-content {
            padding: 25px;
        }
        
        .category-content h3 {
            margin-bottom: 15px;
            color: #2e8b57;
            font-size: 1.3rem;
        }
        
        .category-content p {
            color: #666;
            font-size: 0.95rem;
        }
        
/* ==================================================
   PROFESSIONAL ADMIN DASHBOARD DESIGN (ADD THIS)
   ================================================== */

/* 1. Admin Panel Layout - Full Screen Fixed Layout */
.admin-panel {
    background-color: #f3f4f6; /* மென்மையான சாம்பல் பின்னணி */
    width: 100%;
    height: 100vh;
    overflow: hidden;
}

.admin-wrapper {
    display: flex;
    width: 100%;
    height: 100%;
}

/* 2. Sidebar Design (இடது பக்க மெனு) */
.admin-sidebar {
    width: 260px;
    background-color: #1e293b; /* Professional Dark Blue/Black */
    color: #ffffff;
    display: flex;
    flex-direction: column;
    padding: 20px;
    box-shadow: 4px 0 10px rgba(0,0,0,0.1);
    height: 100%;
    flex-shrink: 0; /* சுருங்காது */
    z-index: 100;
}

.admin-sidebar h3 {
    color: #ffffff;
    font-size: 18px;
    padding-bottom: 20px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    margin-bottom: 20px;
    letter-spacing: 1px;
    text-transform: uppercase;
}

/* Menu Items - ஒன்றன் கீழ் ஒன்றாக */
.admin-menu {
    list-style: none;
    padding: 0;
    display: flex;
    flex-direction: column; /* Vertical Layout */
    gap: 10px; /* பட்டன்களுக்கு இடையில் இடைவெளி */
}

.admin-menu-item {
    padding: 12px 15px;
    border-radius: 8px;
    cursor: pointer;
    color: #94a3b8; /* மங்கலான வெள்ளை */
    font-weight: 500;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 12px;
}

.admin-menu-item i {
    width: 20px;
    text-align: center;
}

/* Hover & Active Effects */
.admin-menu-item:hover {
    background-color: rgba(255,255,255,0.1);
    color: white;
    transform: translateX(5px); /* சிறிது நகரும் */
}

.admin-menu-item.active {
    background-color: #2e8b57; /* உங்கள் பச்சை நிறம் */
    color: white;
    box-shadow: 0 4px 10px rgba(46, 139, 87, 0.4);
}

/* 3. Main Content Area (வலது பக்கம்) */
.admin-content {
    flex: 1; /* மீதமுள்ள இடத்தை எடுக்கும் */
    padding: 30px;
    overflow-y: auto; /* உள்ளே மட்டும் Scroll ஆகும் */
    background-color: #f1f5f9;
}

/* --- Admin Section Visibility Logic --- */

/* 1. எல்லா பிரிவுகளையும் மறைக்கவும் */
.admin-section {
    display: none !important; /* கட்டாயமாக மறைக்க */
}

/* 2. 'active' என்று இருக்கும் பிரிவை மட்டும் காட்டவும் */
.admin-section.active {
    display: block !important; /* கட்டாயமாக காட்ட */
    animation: fadeIn 0.4s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Section Headers */
.section-header h2 {
    font-size: 24px;
    color: #1e293b;
    margin-bottom: 25px;
    font-weight: 700;
    border-left: 5px solid #2e8b57;
    padding-left: 15px;
}

/* 4. Statistics Cards (புள்ளிவிவர அட்டைகள்) */
.admin-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    border: 1px solid #e2e8f0;
    position: relative;
    transition: transform 0.3s;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px rgba(0,0,0,0.1);
}

.stat-card h3 {
    color: #64748b;
    font-size: 14px;
    text-transform: uppercase;
    margin-bottom: 10px;
}

.stat-card .number {
    font-size: 32px;
    font-weight: 700;
    color: #1e293b;
}

.stat-card i {
    position: absolute;
    right: 20px;
    bottom: 20px;
    font-size: 40px;
    color: #2e8b57;
    opacity: 0.1;
}

/* 5. Modern Tables (அட்டவணைகள்) */
.table-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    border: 1px solid #e2e8f0;
    overflow: hidden;
    margin-bottom: 30px;
    padding: 20px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}

th {
    background-color: #f8fafc;
    color: #334155;
    font-weight: 600;
    padding: 15px;
    text-align: left;
    border-bottom: 2px solid #e2e8f0;
    text-transform: uppercase;
    font-size: 12px;
    letter-spacing: 0.5px;
}

td {
    padding: 15px;
    border-bottom: 1px solid #f1f5f9;
    color: #475569;
}

tr:hover {
    background-color: #f8fafc;
}

/* Status Badges */
.status-badge {
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    text-transform: capitalize;
}
.status-approved { background-color: #dcfce7; color: #166534; }
.status-pending { background-color: #fef9c3; color: #854d0e; }
.status-rejected { background-color: #fee2e2; color: #991b1b; }

/* 6. Buttons Styling */
.action-btn {
    padding: 6px 12px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    margin-right: 5px;
    transition: 0.2s;
}

.view-btn { background-color: #e0f2fe; color: #0284c7; }
.view-btn:hover { background-color: #0284c7; color: white; }

.delete-btn { background-color: #fee2e2; color: #dc2626; }
.delete-btn:hover { background-color: #dc2626; color: white; }

.approve-btn { background-color: #dcfce7; color: #166534; }
.reject-btn { background-color: #fee2e2; color: #991b1b; }

/* 7. Input Fields in Admin */
.control-form input {
    width: 100%;
    padding: 12px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    background-color: #f8fafc;
}
.control-form input:focus {
    border-color: #2e8b57;
    outline: none;
    background-color: white;
}


        .control-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .control-card h4 {
            color: #2e8b57;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .control-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .control-form input, .control-form select, .control-form textarea {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .control-form button {
            padding: 10px;
            background-color: #2e8b57;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .control-form button:hover {
            background-color: #246a44;
        }
        
        .users-list, .solutions-table, .submissions-table, .bookings-table, .doctors-table, .providers-table, .provider-bookings-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .users-list th, .users-list td,
        .solutions-table th, .solutions-table td,
        .submissions-table th, .submissions-table td,
        .bookings-table th, .bookings-table td,
        .doctors-table th, .doctors-table td,
        .providers-table th, .providers-table td,
        .provider-bookings-table th, .provider-bookings-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .users-list th, .solutions-table th, .submissions-table th, .bookings-table th, .doctors-table th, .providers-table th, .provider-bookings-table th {
            background-color: #2e8b57;
            color: white;
        }
        
        .users-list tr:hover, .solutions-table tr:hover, .submissions-table tr:hover, .bookings-table tr:hover, .doctors-table tr:hover, .providers-table tr:hover, .provider-bookings-table tr:hover {
            background-color: #f9f9f9;
        }
        
        .action-btn {
            padding: 5px 10px;
            margin-right: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        .edit-btn {
            background-color: #ffc107;
            color: #333;
        }
        
        .delete-btn {
            background-color: #dc3545;
            color: white;
        }
        
        .view-btn {
            background-color: #2e8b57;
            color: white;
        }
        
        .approve-btn {
            background-color: #28a745;
            color: white;
        }
        
        .reject-btn {
            background-color: #dc3545;
            color: white;
        }
        
        .reply-btn {
            background-color: #17a2b8;
            color: white;
        }
        
        /* Submission Modal */
        .submission-modal, .booking-details-modal, .response-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .submission-container, .booking-details-container, .response-container {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            padding: 30px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .submission-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .submission-header h2 {
            color: #2e8b57;
            margin-bottom: 10px;
        }
        
        .submission-details {
            margin-bottom: 20px;
        }
        
        .submission-detail-item {
            display: flex;
            margin-bottom: 15px;
        }
        
        .submission-detail-label {
            font-weight: 500;
            min-width: 120px;
            color: #555;
        }
        
        .submission-detail-value {
            color: #333;
            flex: 1;
        }
        
        /* Service Provider Dashboard */
        .provider-dashboard {
            display: none;
            padding: 40px 0;
        }
        
        .provider-welcome {
            background: linear-gradient(to right, #2e8b57, #3cb371);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .provider-welcome h2 {
            margin-bottom: 10px;
        }
        
        .provider-info-card {
            display: flex;
            align-items: center;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .provider-avatar-large {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 20px;
            border: 3px solid #2e8b57;
        }
        
        .provider-avatar-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .provider-details {
            flex: 1;
        }
        
        .provider-details h3 {
            color: #2e8b57;
            margin-bottom: 5px;
        }
        
        .provider-details p {
            color: #666;
            margin-bottom: 5px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-approved {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .status-rejected {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .status-completed {
            background-color: #d4edda;
            color: #155724;
        }
        
        /* News Section Styles */
        .news-section {
            padding: 60px 0;
            background-color: #f0f8f0;
        }
        
        .news-container {
            margin-top: 30px;
        }
        
        .news-filters {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .news-filter-btn {
            padding: 8px 16px;
            background-color: white;
            border: 2px solid #2e8b57;
            border-radius: 30px;
            color: #2e8b57;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .news-filter-btn.active, .news-filter-btn:hover {
            background-color: #2e8b57;
            color: white;
        }
        
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .news-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
        }
        
        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .news-image {
            height: 180px;
            overflow: hidden;
        }
        
        .news-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .news-card:hover .news-image img {
            transform: scale(1.05);
        }
        
        .news-content {
            padding: 20px;
        }
        
        .news-category {
            display: inline-block;
            padding: 4px 10px;
            background-color: #e6f7ee;
            color: #2e8b57;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-bottom: 10px;
        }
        
        .news-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #333;
        }
        
        .news-excerpt {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        
        .news-date {
            color: #888;
            font-size: 0.85rem;
        }
        
        .no-news {
            text-align: center;
            grid-column: 1 / -1;
            padding: 40px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        /* Read More Button */
        .read-more-btn {
            padding: 8px 15px;
            background: linear-gradient(to right, #2e8b57, #3cb371);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 0;
            display: inline-block;
        }
        
        .read-more-btn:hover {
            background: linear-gradient(to right, #246a44, #2e8b57);
        }
        
        /* News Admin Controls */
        .news-admin-controls {
            margin-top: 30px;
        }
        
        /* Responsive Design */
        @media (max-width: 968px) {
            .user-forms-container {
                grid-template-columns: 1fr;
            }
            
            .news-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .provider-selection {
                flex-direction: column;
                align-items: center;
            }
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            nav ul li {
                margin: 5px 10px;
            }
            
            .user-profile {
                margin-top: 15px;
                justify-content: center;
            }
            
            .section-title {
                font-size: 28px;
            }
            
            .admin-controls {
                grid-template-columns: 1fr;
            }
            
            .users-list, .solutions-table, .submissions-table, .bookings-table, .doctors-table, .providers-table, .provider-bookings-table {
                font-size: 0.9rem;
            }
            
            .users-list th, .users-list td,
            .solutions-table th, .solutions-table td,
            .submissions-table th, .submissions-table td,
            .bookings-table th, .bookings-table td,
            .doctors-table th, .doctors-table td,
            .providers-table th, .providers-table td,
            .provider-bookings-table th, .provider-bookings-table td {
                padding: 8px 10px;
            }
            
            .submission-detail-item {
                flex-direction: column;
            }
            
            .submission-detail-label {
                margin-bottom: 5px;
            }
            
            .news-filters {
                flex-direction: column;
                align-items: center;
            }
            
            .news-filter-btn {
                width: 200px;
                text-align: center;
            }
            
            .provider-info-card {
                flex-direction: column;
                text-align: center;
            }
            
            .provider-avatar-large {
                margin-right: 0;
                margin-bottom: 15px;
            }
        }

        /* Banner Styles */
        .banner {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1532629345422-7515f3d16bb6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1500&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: 100px 20px;
            margin-bottom: 40px;
        }
        
        .banner h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .banner p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }
        
        .tagline {
            font-style: italic;
            margin-top: 20px;
            color: #a2f5bf;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 40px;
            color: #2e8b57;
            font-size: 32px;
            position: relative;
        }
        
        .section-title:after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, #2e8b57, #ff7e00);
            margin: 10px auto;
            border-radius: 2px;
        }
        
        /* Footer */
        footer {
            background-color: #2c3e50;
            color: white;
            padding: 50px 0 20px;
            margin-top: 60px;
        }
        
        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .footer-section {
            flex: 1;
            min-width: 200px;
            margin-bottom: 30px;
        }
        
        .footer-section h3 {
            margin-bottom: 20px;
            color: #3cb371;
            font-size: 1.3rem;
        }
        
        .footer-section ul {
            list-style: none;
            padding: 0;
        }
        
        .footer-section ul li {
            margin-bottom: 10px;
        }
        
        .footer-section a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: #3cb371;
        }
        
        .social-icons {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .social-icons a {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            color: white;
            transition: all 0.3s;
        }
        
        .social-icons a:hover {
            background-color: #3cb371;
            transform: translateY(-3px);
        }
        
        .copyright {
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            font-size: 0.9rem;
            color: #aaa;
        }
        
        /* Doctor Card Styles */
        .doctor-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        
        .doctor-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }
        
        .doctor-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 15px;
        }
        
        /* Service Providers Section */
        .providers-section {
            padding: 60px 0;
            background-color: #f0f8ff;
        }
        
        .providers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .provider-service-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            text-align: center;
            padding: 30px;
        }
        
        .provider-service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.15);
        }
        
        .provider-service-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(to right, #2e8b57, #3cb371);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2rem;
        }
        
        /* Booking Form Styles */
        .booking-form-container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* Tabs for Provider Dashboard */
        .provider-tabs {
            display: flex;
            border-bottom: 2px solid #eee;
            margin-bottom: 30px;
        }
        
        .provider-tab {
            padding: 15px 25px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .provider-tab.active {
            color: #2e8b57;
            border-bottom: 3px solid #2e8b57;
        }
        
        .provider-tab:hover:not(.active) {
            color: #2e8b57;
            background-color: #f9f9f9;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="auth-modal" id="loginModal">
        <div class="auth-container">
            <button class="close-btn" onclick="closeAuthModal()">&times;</button>
            <div class="auth-header">
                <h2 data-i18n="login_title">Login to Your Account</h2>
                <p data-i18n="login_desc">Enter your credentials to access the portal</p>
            </div>
            
            <form class="auth-form" id="loginForm" onsubmit="handleLogin(event)" novalidate>
                <div class="form-group">
                    <label for="loginEmail" data-i18n="email_label">Email Address</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email" data-i18n="email_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword" data-i18n="password_label">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" data-i18n="password_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="loginRole" data-i18n="role_label">Login As</label>
                    <select id="loginRole" required>
                        <option value="" data-i18n="select_role">Select Role</option>
                        <option value="user" data-i18n="role_user">User</option>
                        <option value="doctor" data-i18n="role_doctor">Doctor</option>
                        <option value="draftsman" data-i18n="role_draftsman">Draftsman</option>
                        <option value="admin" data-i18n="role_admin">Admin</option>
                    </select>
                </div>
                
                <button type="submit" data-i18n="login_btn">Login</button>
            </form>
            
            <div class="auth-footer">
                <p><span data-i18n="no_account">Don't have an account?</span> <a onclick="showSignupModal()" data-i18n="signup_link">Sign up here</a></p>
                <p><span data-i18n="is_provider">Are you a service provider?</span> <a onclick="showProviderSelectionModal()" data-i18n="register_link">Register here</a></p>
            </div>
        </div>
    </div>

    <div class="auth-modal" id="signupModal">
        <div class="auth-container">
            <button class="close-btn" onclick="closeAuthModal()">&times;</button>
            <div class="auth-header">
                <h2 data-i18n="create_account">Create an Account</h2>
                <p data-i18n="join_message">Join LifeBridge Rural to access resources</p>
            </div>
            
            <div class="profile-picture-upload">
                <div class="profile-preview">
                    <img src="https://ui-avatars.com/api/?name=User&background=2e8b57&color=fff" alt="Profile Preview" id="profilePreview">
                </div>
                <input type="file" id="profilePicture" accept="image/*" style="display: none;">
                <button type="button" class="submit-btn" onclick="document.getElementById('profilePicture').click()" data-i18n="choose_pic">Choose Profile Picture</button>
            </div>
            
            <form class="auth-form" id="signupForm" onsubmit="handleSignup(event)" novalidate>
                <div class="form-group">
                    <label for="signupName" data-i18n="full_name">Full Name</label>
                    <input type="text" id="signupName" placeholder="Enter your full name" data-i18n="name_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="signupEmail" data-i18n="email_label">Email Address</label>
                    <input type="email" id="signupEmail" placeholder="Enter your email" data-i18n="email_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="signupPassword" data-i18n="password_label">Password</label>
                    <input type="password" id="signupPassword" placeholder="Create a password" data-i18n="create_password_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="signupConfirmPassword" data-i18n="confirm_password">Confirm Password</label>
                    <input type="password" id="signupConfirmPassword" placeholder="Confirm your password" data-i18n="confirm_password_placeholder" required>
                </div>
                
                <input type="hidden" id="signupRole" value="user">
                
                <button type="submit" data-i18n="create_account_btn">Create Account</button>
            </form>
            
            <div class="auth-footer">
                <p><span data-i18n="have_account">Already have an account?</span> <a onclick="showLoginModal()" data-i18n="login_link">Login here</a></p>
                <p><span data-i18n="is_provider">Are you a service provider?</span> <a onclick="showProviderSelectionModal()" data-i18n="register_link">Register here</a></p>
            </div>
        </div>
    </div>

    <div class="provider-modal" id="providerSelectionModal">
        <div class="provider-container">
            <button class="close-btn" onclick="closeProviderModal()">&times;</button>
            <div class="auth-header">
                <h2 data-i18n="register_provider">Register as Service Provider</h2>
                <p data-i18n="select_profession">Select your profession to register</p>
            </div>
            
            <div class="provider-selection">
                <div class="provider-card" onclick="showProviderRegistrationForm('doctor')">
                    <div class="provider-icon">
                        <i class="fas fa-user-md"></i>
                    </div>
                    <h3 data-i18n="doctor">Doctor</h3>
                    <p data-i18n="doctor_desc">Medical professional providing healthcare services</p>
                </div>
                
                <div class="provider-card" onclick="showProviderRegistrationForm('draftsman')">
                    <div class="provider-icon">
                        <i class="fas fa-ruler-combined"></i>
                    </div>
                    <h3 data-i18n="draftsman">Draftsman</h3>
                    <p data-i18n="draftsman_desc">Technical drawing specialist for construction plans</p>
                </div>
            </div>
        </div>
    </div>

    <div class="provider-modal" id="providerRegistrationModal">
        <div class="provider-container">
            <button class="close-btn" onclick="closeProviderRegistrationModal()">&times;</button>
            <div class="auth-header">
                <h2 id="providerFormTitle" data-i18n="register_provider">Register as Service Provider</h2>
                <p id="providerFormSubtitle" data-i18n="provide_details">Please provide your professional details</p>
            </div>
            
            <div class="profile-picture-upload">
                <div class="profile-preview">
                    <img src="https://ui-avatars.com/api/?name=Provider&background=2e8b57&color=fff" alt="Profile Preview" id="providerProfilePreview">
                </div>
                <input type="file" id="providerProfilePicture" accept="image/*" style="display: none;">
                <button type="button" class="submit-btn" onclick="document.getElementById('providerProfilePicture').click()" data-i18n="choose_pic">Choose Profile Picture</button>
            </div>
            
            <form class="auth-form" id="providerRegistrationForm" onsubmit="handleProviderRegistration(event)" novalidate>
                <input type="hidden" id="providerType" value="">
                
                <div class="form-group">
                    <label for="providerName" data-i18n="full_name">Full Name</label>
                    <input type="text" id="providerName" placeholder="Enter your full name" data-i18n="name_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="providerEmail" data-i18n="email_label">Email Address</label>
                    <input type="email" id="providerEmail" placeholder="Enter your email" data-i18n="email_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="providerPassword" data-i18n="password_label">Password</label>
                    <input type="password" id="providerPassword" placeholder="Create a password" data-i18n="create_password_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="providerConfirmPassword" data-i18n="confirm_password">Confirm Password</label>
                    <input type="password" id="providerConfirmPassword" placeholder="Confirm your password" data-i18n="confirm_password_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="providerPhone" data-i18n="phone_number">Phone Number</label>
                    <input type="tel" id="providerPhone" placeholder="Enter your phone number" data-i18n="phone_placeholder" required>
                </div>
                
                <div class="form-group">
                    <label for="providerAddress" data-i18n="address">Address</label>
                    <textarea id="providerAddress" placeholder="Enter your complete address" data-i18n="address_placeholder" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="providerDistrict" data-i18n="district">District</label>
                    <select id="providerDistrict" required onchange="loadPradeshiyaSabhasForProvider()">
                        <option value="" data-i18n="select_district">Select District</option>
                        <option value="ampara">Ampara</option>
                        <option value="anuradhapura">Anuradhapura</option>
                        <option value="badulla">Badulla</option>
                        <option value="batticaloa">Batticaloa</option>
                        <option value="colombo">Colombo</option>
                        <option value="galle">Galle</option>
                        <option value="gampaha">Gampaha</option>
                        <option value="hambantota">Hambantota</option>
                        <option value="jaffna">Jaffna</option>
                        <option value="kalutara">Kalutara</option>
                        <option value="kandy">Kandy</option>
                        <option value="kegalle">Kegalle</option>
                        <option value="kilinochchi">Kilinochchi</option>
                        <option value="kurunegala">Kurunegala</option>
                        <option value="mannar">Mannar</option>
                        <option value="matale">Matale</option>
                        <option value="matara">Matara</option>
                        <option value="monaragala">Monaragala</option>
                        <option value="mullaitivu">Mullaitivu</option>
                        <option value="nuwara-eliya">Nuwara Eliya</option>
                        <option value="polonnaruwa">Polonnaruwa</option>
                        <option value="puttalam">Puttalam</option>
                        <option value="ratnapura">Ratnapura</option>
                        <option value="trincomalee">Trincomalee</option>
                        <option value="vavuniya">Vavuniya</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="providerPradeshiyaSabha" data-i18n="pradeshiya_sabha">Pradeshiya Sabha</label>
                    <select id="providerPradeshiyaSabha" required>
                        <option value="" data-i18n="select_pradeshiya">Select Pradeshiya Sabha</option>
                    </select>
                </div>
                
                <div id="doctorFields" style="display: none;">
                    <div class="form-group">
                        <label for="doctorSpecialization" data-i18n="specialization">Specialization</label>
                        <select id="doctorSpecialization">
                            <option value="" data-i18n="select_spec">Select Specialization</option>
                            <option value="general">General Practitioner</option>
                            <option value="pediatrics">Pediatrics</option>
                            <option value="gynecology">Gynecology</option>
                            <option value="cardiology">Cardiology</option>
                            <option value="dermatology">Dermatology</option>
                            <option value="orthopedics">Orthopedics</option>
                            <option value="psychiatry">Psychiatry</option>
                            <option value="dentistry">Dentistry</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="doctorQualification" data-i18n="qualifications">Qualifications</label>
                        <input type="text" id="doctorQualification" placeholder="MBBS, MD, etc." data-i18n="qual_placeholder">
                    </div>
                    
                    <div class="form-group">
                        <label for="doctorRegistrationNo" data-i18n="med_reg_no">Medical Registration Number</label>
                        <input type="text" id="doctorRegistrationNo" placeholder="Enter your registration number" data-i18n="reg_no_placeholder">
                    </div>
                    
                    <div class="form-group">
                        <label for="doctorExperience" data-i18n="experience">Years of Experience</label>
                        <input type="number" id="doctorExperience" placeholder="Number of years" data-i18n="exp_placeholder" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="doctorHospital" data-i18n="hospital_clinic">Hospital/Clinic Name</label>
                        <input type="text" id="doctorHospital" placeholder="Name of your hospital or clinic" data-i18n="hospital_placeholder">
                    </div>
                    
                    <div class="form-group">
                        <label for="doctorAvailability" data-i18n="availability">Availability</label>
                        <input type="text" id="doctorAvailability" placeholder="e.g., Mon-Fri 9am-5pm, Sat 9am-1pm" data-i18n="avail_placeholder">
                    </div>
                    
                    <div class="form-group">
                        <label for="doctorConsultationFee" data-i18n="consult_fee">Consultation Fee (LKR)</label>
                        <input type="number" id="doctorConsultationFee" placeholder="Fee per consultation" data-i18n="fee_placeholder" min="0">
                    </div>
                </div>
                
                <div id="draftsmanFields" style="display: none;">
                    <div class="form-group">
                        <label for="draftsmanQualification" data-i18n="qualifications">Qualifications</label>
                        <input type="text" id="draftsmanQualification" placeholder="Diploma/Degree in Drafting, etc." data-i18n="draft_qual_placeholder">
                    </div>
                    
                    <div class="form-group">
                        <label for="draftsmanRegistrationNo" data-i18n="prof_reg_no">Professional Registration Number</label>
                        <input type="text" id="draftsmanRegistrationNo" placeholder="Enter your registration number" data-i18n="reg_no_placeholder">
                    </div>
                    
                    <div class="form-group">
                        <label for="draftsmanExperience" data-i18n="experience">Years of Experience</label>
                        <input type="number" id="draftsmanExperience" placeholder="Number of years" data-i18n="exp_placeholder" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="draftsmanServices" data-i18n="services_offered">Services Offered</label>
                        <textarea id="draftsmanServices" placeholder="List the services you offer (e.g., house plans, site plans, etc.)" data-i18n="services_placeholder" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="draftsmanRate" data-i18n="service_rate">Service Rate (LKR)</label>
                        <input type="text" id="draftsmanRate" placeholder="e.g., 10,000 per plan or hourly rate" data-i18n="rate_placeholder">
                    </div>
                    
                    <div class="form-group">
                        <label for="draftsmanAvailability" data-i18n="availability">Availability</label>
                        <input type="text" id="draftsmanAvailability" placeholder="e.g., Mon-Fri 9am-5pm, Weekends by appointment" data-i18n="avail_placeholder">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="providerBio" data-i18n="bio">Professional Bio</label>
                    <textarea id="providerBio" placeholder="Tell us about your professional background and experience" data-i18n="bio_placeholder" rows="4" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="providerTerms" required>
                        <span data-i18n="terms_certify">I certify that all information provided is accurate and I am a legitimate professional in my field</span>
                    </label>
                </div>
                
                <button type="submit" data-i18n="submit_reg">Submit Registration</button>
            </form>
            
            <div class="auth-footer">
                <p><span data-i18n="have_account">Already have an account?</span> <a onclick="showLoginModal()" data-i18n="login_link">Login here</a></p>
            </div>
        </div>
    </div>

    <div class="submission-modal" id="submissionModal">
        <div class="submission-container">
            <button class="close-btn" onclick="closeSubmissionModal()">&times;</button>
            <div class="submission-header">
                <h2 data-i18n="prob_submit_title">User Problem Submission</h2>
                <p data-i18n="prob_submit_desc">Detailed information about the user's problem</p>
            </div>
            
            <div class="submission-details" id="submissionDetails">
                </div>
        </div>
    </div>

    <div class="booking-details-modal" id="bookingDetailsModal">
        <div class="booking-details-container">
            <button class="close-btn" onclick="closeBookingDetailsModal()">&times;</button>
            <div class="submission-header">
                <h2 id="bookingDetailsTitle" data-i18n="booking_details_title">Booking Details</h2>
                <p data-i18n="booking_details_desc">Detailed information about the booking</p>
            </div>
            
            <div class="submission-details" id="bookingDetailsContent">
                </div>
            
            <div id="responseSection" style="display: none; margin-top: 20px;">
                <h3 style="color: #2e8b57; margin-bottom: 15px;" data-i18n="your_response">Your Response</h3>
                <div id="existingResponse">
                    </div>
                <div id="responseFormContainer">
                    <textarea id="providerResponse" placeholder="Enter your response to the user..." data-i18n="response_placeholder" rows="4" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 15px;"></textarea>
                    <div style="display: flex; gap: 10px;">
                        <button type="button" class="submit-btn" onclick="submitProviderResponse()" style="flex: 1;" data-i18n="submit_response">Submit Response</button>
                        <button type="button" class="submit-btn" onclick="markBookingAsCompleted()" style="flex: 1; background: linear-gradient(to right, #28a745, #20c997);" data-i18n="mark_completed">Mark as Completed</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="response-modal" id="responseModal">
        <div class="response-container">
            <button class="close-btn" onclick="closeResponseModal()">&times;</button>
            <div class="submission-header">
                <h2 data-i18n="provider_response_title">Provider Response</h2>
                <p data-i18n="provider_response_desc">Provider's response to your booking</p>
            </div>
            
            <div class="submission-details" id="responseDetails">
                </div>
        </div>
    </div>

<header>
    <div class="container header-container">
        
        <div class="logo-container">
            <div class="logo">
                <img src="logo.jpg" alt="Logo" id="siteLogo">
            </div>
            <div class="title" data-i18n="app_title">Life<span>Bridge</span> Rural</div>
        </div>

<nav>
    <ul>
        <li><a href="#" onclick="showHome()" data-i18n="nav_home">Home</a></li>
        
        <li>
            <a href="#" style="cursor: default;">
                <span data-i18n="nav_dashboard">Dashboards</span> 
                <i class="fas fa-chevron-down" style="font-size: 12px; margin-left: 5px;"></i>
            </a>
            <div class="dropdown-menu">
                <a href="#" onclick="showAdminPanel()"><i class="fas fa-user-shield"></i> <span data-i18n="nav_admin">Admin Dashboard</span></a>
                <a href="#" onclick="showDashboard()"><i class="fas fa-user"></i> <span data-i18n="nav_dashboard">User Dashboard</span></a>
                <a href="#" onclick="showProviderDashboard()"><i class="fas fa-user-md"></i> <span data-i18n="nav_provider_dashboard">Provider Dashboard</span></a>
            </div>
        </li>

        <li><a href="#" onclick="showServiceProvidersPage()" data-i18n="nav_providers">Service Providers</a></li>
        
        <li><a href="#" onclick="showContact()" data-i18n="nav_contact">Contact</a></li>
    </ul>
</nav>

        <div class="user-actions">
            <div class="user-profile" id="userProfileSection" style="display: none;">
                <div class="user-avatar">
                    <img src="https://ui-avatars.com/api/?name=User&background=2e8b57&color=fff" alt="User" id="userAvatar">
                </div>
                <div class="user-name" id="userName" data-i18n="guest">Guest</div>
            </div>

            <a class="login-btn" id="authButton" onclick="showLoginModal()" data-i18n="login_btn">Login</a>

            <select class="lang-select" id="languageSelector" onchange="changeLanguage(this.value)">
                <option value="en">English</option>
                <option value="ta">தமிழ்</option>
                <option value="si">සිංහල</option>
            </select>
        </div>

    </div>
</header>


    <div class="home-content" id="homeContent">
        <section class="banner">
            <div class="container">
                <h1 data-i18n="hero_title">Bridging Sri Lankan Villages to Resources</h1>
                <p data-i18n="hero_desc">LifeBridge Rural is designed to act as a bridge between rural communities in Sri Lanka and the resources they need to thrive</p>
                <p class="tagline" data-i18n="hero_tagline">"Connecting rural Sri Lankan communities to opportunities, resources, and a brighter future"</p>
            </div>
        </section>

        <section class="categories">
            <div class="container">
                <h2 class="section-title" data-i18n="challenges_title">Key Challenges for Rural Sri Lankan Communities</h2>
                <div class="categories-grid">
                    <div class="category-card">
                        <div class="category-icon"><i class="fas fa-landmark"></i></div>
                        <div class="category-content">
                            <h3 data-i18n="cat_govt_schemes">Government Schemes & Financial Aid</h3>
                            <p data-i18n="cat_govt_desc">Information on schemes like "Gama Samaga Pilisandarak", "Divi Neguma", and other rural development programs.</p>
                        </div>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon"><i class="fas fa-file-alt"></i></div>
                        <div class="category-content">
                            <h3 data-i18n="cat_regulations">Government Regulations & Permissions</h3>
                            <p data-i18n="cat_reg_desc">Guidance on obtaining permits for agriculture, small businesses, and housing in rural areas.</p>
                        </div>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon"><i class="fas fa-heartbeat"></i></div>
                        <div class="category-content">
                            <h3 data-i18n="cat_health">Health & Safety</h3>
                            <p data-i18n="cat_health_desc">Access to information about rural health services, CKDu prevention, and maternal healthcare programs.</p>
                        </div>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon"><i class="fas fa-tractor"></i></div>
                        <div class="category-content">
                            <h3 data-i18n="cat_agri">Agriculture & Market</h3>
                            <p data-i18n="cat_agri_desc">Support for tea, rubber, coconut, and spice farmers with market prices and modern techniques.</p>
                        </div>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon"><i class="fas fa-hands-helping"></i></div>
                        <div class="category-content">
                            <h3 data-i18n="cat_welfare">Social Welfare & Others</h3>
                            <p data-i18n="cat_welfare_desc">Information on Samurdhi benefits, educational scholarships, and vocational training programs.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="news-section" id="newsSection">
            <div class="container">
                <h2 class="section-title" data-i18n="latest_news">Latest News & Updates</h2>
                
                <div class="news-filters">
                    <button class="news-filter-btn active" data-category="all" data-i18n="all_news">All News</button>
                    <button class="news-filter-btn" data-category="government" data-i18n="cat_govt_schemes">Government Schemes</button>
                    <button class="news-filter-btn" data-category="regulations" data-i18n="cat_regulations">Regulations</button>
                    <button class="news-filter-btn" data-category="health" data-i18n="cat_health">Health & Safety</button>
                    <button class="news-filter-btn" data-category="agriculture" data-i18n="cat_agri">Agriculture</button>
                    <button class="news-filter-btn" data-category="welfare" data-i18n="cat_welfare">Social Welfare</button>
                </div>
                
                <div class="news-container">
                    <div class="news-grid" id="newsGrid">
                        </div>
                </div>
            </div>
        </section>
    </div>

<section class="providers-section" id="serviceProvidersSection" style="display: none;">
        <div class="container">
            <h2 class="section-title" data-i18n="our_service_providers">Our Service Providers</h2>
            <p style="text-align: center; max-width: 800px; margin: 0 auto 30px; color: #666;" data-i18n="providers_intro">
                Connect with certified professionals who can help you with your specific needs. All providers are verified by our admin team.
            </p>
            
            <div class="providers-grid">
                <div class="provider-service-card">
                    <div class="provider-service-icon"><i class="fas fa-user-md"></i></div>
                    <h3 data-i18n="medical_services">Medical Services</h3>
                    <p data-i18n="medical_services_desc">Book appointments with certified doctors specializing in various fields. Get medical consultations and health advice.</p>
                    <div style="margin-top: 20px;">
                        <button class="read-more-btn" onclick="showAvailableDoctors()" data-i18n="view_doctors">View Available Doctors</button>
                        <button class="read-more-btn" style="background: linear-gradient(to right, #ff7e00, #ff9f40); margin-top: 10px; color: white;" onclick="bookDoctor()" data-i18n="book_doctor">Book a Doctor</button>
                    </div>
                </div>
                
                <div class="provider-service-card">
                    <div class="provider-service-icon"><i class="fas fa-ruler-combined"></i></div>
                    <h3 data-i18n="draftsman_services">Draftsman Services</h3>
                    <p data-i18n="draftsman_services_desc">Get professional drafting services for construction plans, site plans, and architectural drawings for your projects.</p>
                    <div style="margin-top: 20px;">
                        <button class="read-more-btn" onclick="showAvailableDraftsmen()" data-i18n="view_draftsmen">View Available Draftsmen</button>
                        <button class="read-more-btn" style="background: linear-gradient(to right, #ff7e00, #ff9f40); margin-top: 10px; color: white;" onclick="bookDraftsman()" data-i18n="book_draftsman">Book a Draftsman</button>
                    </div>
                </div>
            </div>
            
            <div id="availableDoctors" style="display: none; margin-top: 40px;">
                <h3 style="color: #2e8b57; margin-bottom: 20px; text-align: center;" data-i18n="available_doctors_title">Available Doctors</h3>
                <div id="doctorsList" class="categories-grid"></div>
            </div>
            
            <div id="availableDraftsmen" style="display: none; margin-top: 40px;">
                <h3 style="color: #2e8b57; margin-bottom: 20px; text-align: center;" data-i18n="available_draftsmen_title">Available Draftsmen</h3>
                <div id="draftsmenList" class="categories-grid"></div>
            </div>
            
            <div id="doctorBookingForm" class="booking-form-container" style="display: none;">
                <h3 style="color: #2e8b57; margin-bottom: 20px;" data-i18n="book_doctor">Book a Doctor Appointment</h3>
                <form id="doctorBookingFormContent" onsubmit="submitDoctorBooking(event)" novalidate>
                    <div class="form-group">
                        <label data-i18n="select_doctor">Select Doctor</label>
                        <select id="bookingDoctor" required><option value="">Select a doctor</option></select>
                    </div>
                    <div class="form-group">
                        <label data-i18n="patient_name">Patient Name</label>
                        <input type="text" id="patientName" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="patient_age">Patient Age</label>
                        <input type="number" id="patientAge" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="patient_gender">Patient Gender</label>
                        <select id="patientGender" required>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label data-i18n="medical_issue">Medical Issue</label>
                        <textarea id="medicalIssue" required></textarea>
                    </div>
                    <div class="form-group">
                        <label data-i18n="pref_date">Preferred Date</label>
                        <input type="date" id="preferredDate" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="pref_time">Preferred Time</label>
                        <input type="time" id="preferredTime" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="contact_num">Contact Number</label>
                        <input type="tel" id="bookingContact" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="add_notes">Additional Notes</label>
                        <textarea id="bookingNotes"></textarea>
                    </div>
                    <button type="submit" class="submit-btn" data-i18n="book_appoint_btn">Book Appointment</button>
                    <button type="button" class="submit-btn" onclick="cancelBooking()" style="background: #64748b; margin-left: 10px;" data-i18n="cancel_btn">Cancel</button>
                </form>
            </div>

            <div id="draftsmanBookingForm" class="booking-form-container" style="display: none;">
                <h3 style="color: #2e8b57; margin-bottom: 20px;" data-i18n="book_draftsman">Book a Draftsman</h3>
                <form id="draftsmanBookingFormContent" onsubmit="submitDraftsmanBooking(event)" novalidate>
                    <div class="form-group">
                        <label data-i18n="select_draftsman">Select Draftsman</label>
                        <select id="bookingDraftsman" required><option value="">Select a draftsman</option></select>
                    </div>
                    <div class="form-group">
                        <label data-i18n="client_name">Client Name</label>
                        <input type="text" id="clientName" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="project_type">Project Type</label>
                        <select id="projectType" required>
                            <option value="house">House Plan</option>
                            <option value="commercial">Commercial</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label data-i18n="project_details">Project Details</label>
                        <textarea id="projectDetails" required></textarea>
                    </div>
                    <div class="form-group">
                        <label data-i18n="prop_address">Property Address</label>
                        <textarea id="propertyAddress" required></textarea>
                    </div>
                    <div class="form-group">
                        <label data-i18n="prop_size">Property Size (perches)</label>
                        <input type="number" id="propertySize" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="site_visit_date">Preferred Visit Date</label>
                        <input type="date" id="preferredVisitDate" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="contact_num">Contact Number</label>
                        <input type="tel" id="draftsmanContact" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="budget_est">Budget Estimate (LKR)</label>
                        <input type="number" id="draftsmanBudget" required>
                    </div>
                    <button type="submit" class="submit-btn" data-i18n="book_draftsman_btn">Book Draftsman</button>
                    <button type="button" class="submit-btn" onclick="cancelBooking()" style="background: #64748b; margin-left: 10px;" data-i18n="cancel_btn">Cancel</button>
                </form>
            </div>
        </div>
    </section>

<div class="container" id="contactPage" style="display: none; padding: 60px 0;">
        <h2 class="section-title" data-i18n="contact_title">Contact Us</h2>
        
        <div class="contact-wrapper" style="display: flex; flex-wrap: wrap; gap: 40px; justify-content: center;">
            
            <div class="contact-info-box" style="flex: 1; min-width: 300px; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <h3 style="color: #2e8b57; margin-bottom: 20px;">Get in Touch</h3>
                
                <div style="margin-bottom: 20px; display: flex; align-items: start; gap: 15px;">
                    <i class="fas fa-map-marker-alt" style="color: #ff7e00; font-size: 20px; margin-top: 5px;"></i>
                    <div>
                        <strong style="display: block; margin-bottom: 5px;">Head Office</strong>
                        <p style="color: #666; font-size: 0.95rem;">No. 123, Rural Development Center,<br>Main Street, Colombo 01,<br>Sri Lanka.</p>
                    </div>
                </div>

                <div style="margin-bottom: 20px; display: flex; align-items: center; gap: 15px;">
                    <i class="fas fa-phone-alt" style="color: #ff7e00; font-size: 20px;"></i>
                    <div>
                        <strong style="display: block; margin-bottom: 5px;">Phone</strong>
                        <p style="color: #666; margin: 0;">+94 11 234 5678</p>
                        <p style="color: #666; margin: 0;">+94 77 123 4567 (Hotline)</p>
                    </div>
                </div>

                <div style="margin-bottom: 30px; display: flex; align-items: center; gap: 15px;">
                    <i class="fas fa-envelope" style="color: #ff7e00; font-size: 20px;"></i>
                    <div>
                        <strong style="display: block; margin-bottom: 5px;">Email</strong>
                        <p style="color: #666; margin: 0;">support@lifebridgerural.lk</p>
                        <p style="color: #666; margin: 0;">info@lifebridgerural.lk</p>
                    </div>
                </div>

                <div class="map-container" style="border-radius: 10px; overflow: hidden; height: 250px;">
                    <iframe 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d63320.4300203597!2d79.82118600577717!3d6.921837369399824!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3ae253d10f7a7003%3A0x320b2e4d32d3838d!2sColombo%2C%20Sri%20Lanka!5e0!3m2!1sen!2slk!4v1709228812345!5m2!1sen!2slk" 
                        width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>

            <div class="form-card" style="flex: 1; min-width: 300px;">
                <h3 style="color: #2e8b57; margin-bottom: 20px;">Send a Message</h3>
                <form>
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" placeholder="Your Name" required style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" placeholder="Your Email" required style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>
                    <div class="form-group">
                        <label>Subject</label>
                        <select style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px;">
                            <option>General Inquiry</option>
                            <option>Technical Support</option>
                            <option>Feedback</option>
                            <option>Report Issue</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea placeholder="Your Message" rows="5" required style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px;"></textarea>
                    </div>
                    <button type="submit" class="submit-btn" style="width: 100%;">Send Message</button>
                </form>
            </div>

        </div>
    </div>

    <div class="dashboard container" id="userDashboard">
        <div class="dashboard-header">
            <h2 data-i18n="welcome_dash">Welcome to Your Dashboard</h2>
            <p data-i18n="dash_desc">Manage your profile and submit your problems for assistance</p>
        </div>
        
        <div class="user-forms-container">
            <div class="form-card">
                <h3 data-i18n="personal_info">Personal Information</h3>
                <form id="personalInfoForm" onsubmit="updatePersonalInfo(event)" novalidate>
                    <div class="form-group">
                        <label for="personalName" data-i18n="full_name">Full Name</label>
                        <input type="text" id="personalName" placeholder="Enter your full name" data-i18n="name_placeholder" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="personalEmail" data-i18n="email_label">Email Address</label>
                        <input type="email" id="personalEmail" placeholder="Enter your email" data-i18n="email_placeholder" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="personalPhone" data-i18n="phone_number">Phone Number</label>
                        <input type="tel" id="personalPhone" placeholder="Enter your phone number" data-i18n="phone_placeholder" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="personalAddress" data-i18n="address">Address</label>
                        <textarea id="personalAddress" placeholder="Enter your complete address" data-i18n="address_placeholder" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="personalDistrict" data-i18n="district">District</label>
                        <select id="personalDistrict" required>
                            <option value="" data-i18n="select_district">Select District</option>
                            <option value="ampara">Ampara</option>
                            <option value="anuradhapura">Anuradhapura</option>
                            <option value="badulla">Badulla</option>
                            <option value="batticaloa">Batticaloa</option>
                            <option value="colombo">Colombo</option>
                            <option value="galle">Galle</option>
                            <option value="gampaha">Gampaha</option>
                            <option value="hambantota">Hambantota</option>
                            <option value="jaffna">Jaffna</option>
                            <option value="kalutara">Kalutara</option>
                            <option value="kandy">Kandy</option>
                            <option value="kegalle">Kegalle</option>
                            <option value="kilinochchi">Kilinochchi</option>
                            <option value="kurunegala">Kurunegala</option>
                            <option value="mannar">Mannar</option>
                            <option value="matale">Matale</option>
                            <option value="matara">Matara</option>
                            <option value="monaragala">Monaragala</option>
                            <option value="mullaitivu">Mullaitivu</option>
                            <option value="nuwara-eliya">Nuwara Eliya</option>
                            <option value="polonnaruwa">Polonnaruwa</option>
                            <option value="puttalam">Puttalam</option>
                            <option value="ratnapura">Ratnapura</option>
                            <option value="trincomalee">Trincomalee</option>
                            <option value="vavuniya">Vavuniya</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="personalPradeshiyaSabha" data-i18n="pradeshiya_sabha">Pradeshiya Sabha</label>
                        <input type="text" id="personalPradeshiyaSabha" placeholder="Enter your Pradeshiya Sabha" data-i18n="pradeshiya_placeholder">
                    </div>
                    
                    <button type="submit" class="submit-btn" data-i18n="update_info_btn">Update Information</button>
                </form>
            </div>
            
            <div class="form-card">
                <h3 data-i18n="submit_problem">Submit Your Problem</h3>
                <form id="problemForm" onsubmit="submitProblemForm(event)" novalidate>
                    <div class="form-group">
                        <label for="problemCategory" data-i18n="prob_category">Problem Category</label>
                        <select id="problemCategory" required>
                            <option value="" data-i18n="select_category">Select a category</option>
                            <option value="government" data-i18n="cat_govt_schemes">Government Schemes & Financial Aid</option>
                            <option value="regulations" data-i18n="cat_regulations">Government Regulations & Permissions</option>
                            <option value="health" data-i18n="cat_health">Health & Safety</option>
                            <option value="agriculture" data-i18n="cat_agri">Agriculture & Market</option>
                            <option value="welfare" data-i18n="cat_welfare">Social Welfare & Others</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="problemTitle" data-i18n="prob_title">Problem Title</label>
                        <input type="text" id="problemTitle" placeholder="Brief title of your problem" data-i18n="prob_title_placeholder" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="problemDescription" data-i18n="prob_desc">Problem Description</label>
                        <textarea id="problemDescription" placeholder="Please describe your problem in detail..." data-i18n="prob_desc_placeholder" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="problemLocation" data-i18n="location_village">Location/Village</label>
                        <input type="text" id="problemLocation" placeholder="Enter your village or location" data-i18n="loc_placeholder" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="problemContact" data-i18n="contact_num">Contact Number</label>
                        <input type="tel" id="problemContact" placeholder="Enter your contact number" data-i18n="contact_placeholder" required>
                    </div>
                    
                    <button type="submit" class="submit-btn" data-i18n="submit_prob_btn">Submit Problem</button>
                </form>
            </div>
        </div>
        
        <div class="form-card" style="margin-top: 30px;">
            <h3 data-i18n="your_bookings">Your Bookings</h3>
            <div id="userBookingsList">
                </div>
        </div>
        
        <h2 class="section-title" data-i18n="browse_solutions">Browse Solutions by Category</h2>
        <div class="categories-grid">
            <div class="category-card" onclick="navigateToCategory('government')">
                <div class="category-icon"><i class="fas fa-landmark"></i></div>
                <div class="category-content">
                    <h3 data-i18n="cat_govt_schemes">Government Schemes & Financial Aid</h3>
                    <p data-i18n="cat_govt_help">Find information about government programs and financial assistance.</p>
                </div>
            </div>
            
            <div class="category-card" onclick="navigateToCategory('regulations')">
                <div class="category-icon"><i class="fas fa-file-alt"></i></div>
                <div class="category-content">
                    <h3 data-i18n="cat_regulations">Government Regulations & Permissions</h3>
                    <p data-i18n="cat_reg_help">Guidance on permits, licenses and regulatory requirements.</p>
                </div>
            </div>
            
            <div class="category-card" onclick="navigateToCategory('health')">
                <div class="category-icon"><i class="fas fa-heartbeat"></i></div>
                <div class="category-content">
                    <h3 data-i18n="cat_health">Health & Safety</h3>
                    <p data-i18n="cat_health_help">Healthcare services, safety guidelines and wellness programs.</p>
                </div>
            </div>
            
            <div class="category-card" onclick="navigateToCategory('agriculture')">
                <div class="category-icon"><i class="fas fa-tractor"></i></div>
                <div class="category-content">
                    <h3 data-i18n="cat_agri">Agriculture & Market</h3>
                    <p data-i18n="cat_agri_help">Farming techniques, market prices and agricultural support.</p>
                </div>
            </div>
            
            <div class="category-card" onclick="navigateToCategory('welfare')">
                <div class="category-icon"><i class="fas fa-hands-helping"></i></div>
                <div class="category-content">
                    <h3 data-i18n="cat_welfare">Social Welfare & Others</h3>
                    <p data-i18n="cat_welfare_help">Social programs, educational support and community services.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="provider-dashboard container" id="providerDashboard">
        <div class="dashboard-header">
            <h2 data-i18n="provider_dash_title">Service Provider Dashboard</h2>
            <p data-i18n="provider_dash_desc">Manage your professional profile and respond to bookings</p>
        </div>
        
        <div class="provider-welcome">
            <h2><span data-i18n="welcome">Welcome</span>, <span id="providerWelcomeName">Provider</span></h2>
            <p><span data-i18n="logged_in_as">You are logged in as a</span> <span id="providerTypeDisplay">Service Provider</span></p>
        </div>
        
        <div class="provider-info-card">
            <div class="provider-avatar-large">
                <img src="https://ui-avatars.com/api/?name=Provider&background=2e8b57&color=fff" alt="Provider" id="providerDashboardAvatar">
            </div>
            <div class="provider-details">
                <h3 id="providerDashboardName">Provider Name</h3>
                <p id="providerDashboardSpecialization" data-i18n="specialization">Specialization</p>
                <p id="providerDashboardLocation" data-i18n="location">Location</p>
                <p id="providerDashboardContact" data-i18n="contact_info">Contact Information</p>
                <span class="status-badge" id="providerDashboardStatus">Status</span>
                <p id="providerDashboardBio" style="margin-top: 10px;" data-i18n="bio_will_appear">Professional bio will appear here</p>
            </div>
        </div>
        
        <div class="provider-tabs">
            <button class="provider-tab active" onclick="switchProviderTab('bookings')" data-i18n="my_bookings">My Bookings</button>
            <button class="provider-tab" onclick="switchProviderTab('profile')" data-i18n="my_profile">My Profile</button>
            <button class="provider-tab" onclick="switchProviderTab('availability')" data-i18n="availability">Availability</button>
        </div>
        
        <div id="providerBookingsTab" class="tab-content active">
            <div class="form-card">
                <h3 data-i18n="your_bookings">Your Bookings</h3>
                <p data-i18n="manage_bookings">Manage and respond to customer bookings</p>
                
                <table class="provider-bookings-table">
                    <thead>
                        <tr>
                            <th data-i18n="customer">Customer</th>
                            <th data-i18n="service_type">Service Type</th>
                            <th data-i18n="date">Date</th>
                            <th data-i18n="status">Status</th>
                            <th data-i18n="actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="providerBookingsTableBody">
                        </tbody>
                </table>
            </div>
        </div>
        
        <div id="providerProfileTab" class="tab-content">
            <div class="form-card">
                <h3 data-i18n="update_profile">Update Your Profile</h3>
                <form id="providerProfileForm" onsubmit="updateProviderProfile(event)" novalidate>
                    <div class="form-group">
                        <label for="updateProviderName" data-i18n="full_name">Full Name</label>
                        <input type="text" id="updateProviderName" placeholder="Enter your full name" data-i18n="name_placeholder" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="updateProviderPhone" data-i18n="phone_number">Phone Number</label>
                        <input type="tel" id="updateProviderPhone" placeholder="Enter your phone number" data-i18n="phone_placeholder" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="updateProviderAddress" data-i18n="address">Address</label>
                        <textarea id="updateProviderAddress" placeholder="Enter your complete address" data-i18n="address_placeholder" rows="3" required></textarea>
                    </div>
                    
                    <div id="doctorProfileFields" style="display: none;">
                        <div class="form-group">
                            <label for="updateDoctorHospital" data-i18n="hospital_clinic">Hospital/Clinic Name</label>
                            <input type="text" id="updateDoctorHospital" placeholder="Name of your hospital or clinic" data-i18n="hospital_placeholder" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="updateDoctorAvailability" data-i18n="availability">Availability</label>
                            <input type="text" id="updateDoctorAvailability" placeholder="e.g., Mon-Fri 9am-5pm, Sat 9am-1pm" data-i18n="avail_placeholder" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="updateDoctorConsultationFee" data-i18n="consult_fee">Consultation Fee (LKR)</label>
                            <input type="number" id="updateDoctorConsultationFee" placeholder="Fee per consultation" data-i18n="fee_placeholder" min="0" required>
                        </div>
                    </div>
                    
                    <div id="draftsmanProfileFields" style="display: none;">
                        <div class="form-group">
                            <label for="updateDraftsmanServices" data-i18n="services_offered">Services Offered</label>
                            <textarea id="updateDraftsmanServices" placeholder="List the services you offer" data-i18n="services_placeholder" rows="3" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="updateDraftsmanRate" data-i18n="service_rate">Service Rate (LKR)</label>
                            <input type="text" id="updateDraftsmanRate" placeholder="e.g., 10,000 per plan or hourly rate" data-i18n="rate_placeholder" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="updateDraftsmanAvailability" data-i18n="availability">Availability</label>
                            <input type="text" id="updateDraftsmanAvailability" placeholder="e.g., Mon-Fri 9am-5pm, Weekends by appointment" data-i18n="avail_placeholder" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="updateProviderBio" data-i18n="bio">Professional Bio</label>
                        <textarea id="updateProviderBio" placeholder="Tell us about your professional background and experience" data-i18n="bio_placeholder" rows="4" required></textarea>
                    </div>
                    
                    <button type="submit" class="submit-btn" data-i18n="update_profile_btn">Update Profile</button>
                </form>
            </div>
        </div>
        
        <div id="providerAvailabilityTab" class="tab-content">
            <div class="form-card">
                <h3 data-i18n="manage_avail">Manage Your Availability</h3>
                <div class="form-group">
                    <label><span data-i18n="curr_status">Current Status:</span> <span id="currentAvailabilityStatus" style="color: #2e8b57; font-weight: bold;">Available</span></label>
                    <div style="margin-top: 15px;">
                        <button type="button" class="submit-btn" onclick="changeAvailabilityStatus('available')" style="background: linear-gradient(to right, #28a745, #20c997); margin-right: 10px;" data-i18n="mark_avail">Mark as Available</button>
                        <button type="button" class="submit-btn" onclick="changeAvailabilityStatus('busy')" style="background: linear-gradient(to right, #ffc107, #ffd54f); margin-right: 10px;" data-i18n="mark_busy">Mark as Busy</button>
                        <button type="button" class="submit-btn" onclick="changeAvailabilityStatus('unavailable')" style="background: linear-gradient(to right, #dc3545, #e35d6a);" data-i18n="mark_unavail">Mark as Unavailable</button>
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 30px;">
                    <h4 data-i18n="upcoming_bookings">Upcoming Bookings</h4>
                    <div id="providerUpcomingBookings">
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div class="admin-panel" id="adminPanel" style="display: none;">
        <div class="admin-wrapper">
            <nav class="admin-sidebar">
                <h3 data-i18n="admin_panel_title"><i class="fas fa-shield-alt"></i> Admin Panel</h3>
                <ul class="admin-menu">
                    <li class="admin-menu-item active" onclick="switchAdminSection('overview')">
                        <i class="fas fa-chart-line"></i> <span data-i18n="admin_overview">Overview</span>
                    </li>
                    <li class="admin-menu-item" onclick="switchAdminSection('users')">
                        <i class="fas fa-users"></i> <span data-i18n="admin_users">Users Management</span>
                    </li>
                    <li class="admin-menu-item" onclick="switchAdminSection('providers')">
                        <i class="fas fa-user-md"></i> <span data-i18n="admin_providers">Service Providers</span>
                    </li>
                    <li class="admin-menu-item" onclick="switchAdminSection('bookings')">
                        <i class="fas fa-calendar-check"></i> <span data-i18n="admin_bookings">Bookings</span>
                    </li>
                    <li class="admin-menu-item" onclick="switchAdminSection('submissions')">
                        <i class="fas fa-envelope-open-text"></i> <span data-i18n="admin_problems">User Problems</span>
                    </li>
                    <li class="admin-menu-item" onclick="switchAdminSection('news')">
                        <i class="fas fa-newspaper"></i> <span data-i18n="admin_news">Manage News</span>
                    </li>
                    <li class="admin-menu-item" onclick="switchAdminSection('reports')">
                        <i class="fas fa-file-alt"></i> <span data-i18n="admin_reports">Data Reports</span>
                    </li>
                </ul>
            </nav>

            <main class="admin-content">

                <div id="admin-overview" class="admin-section active">
                    <div class="section-header">
                        <h2 data-i18n="dash_overview">Dashboard Overview</h2>
                    </div>
                    
                    <div class="admin-stats">
                        <div class="stat-card">
                            <h3 data-i18n="total_users">Total Users</h3>
                            <div class="number" id="totalUsers">0</div>
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-card">
                            <h3 data-i18n="service_providers">Service Providers</h3>
                            <div class="number" id="totalProviders">0</div>
                            <i class="fas fa-user-md"></i>
                        </div>
                        <div class="stat-card">
                            <h3 data-i18n="total_bookings">Total Bookings</h3>
                            <div class="number" id="totalBookings">0</div>
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-card">
                            <h3 data-i18n="pending_approvals">Pending Approvals</h3>
                            <div class="number" id="pendingApprovals">0</div>
                            <i class="fas fa-clock"></i>
                        </div>
                    </div>
                </div>

                <div id="admin-users" class="admin-section">
                    <div class="section-header"><h2 data-i18n="user_mgmt">User Management</h2></div>
                    <div class="table-card">
                        <div class="control-form">
                            <input type="text" id="userSearch" placeholder="Search users by name or email..." data-i18n="search_users_ph" onkeyup="searchUsers()" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:6px;">
                        </div>
                        <div style="overflow-x:auto;">
                            <table class="users-list">
                                <thead><tr><th data-i18n="name">Name</th><th data-i18n="email">Email</th><th data-i18n="role">Role</th><th data-i18n="status">Status</th><th data-i18n="actions">Actions</th></tr></thead>
                                <tbody id="usersTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="admin-providers" class="admin-section">
                    <div class="section-header"><h2 data-i18n="provider_mgmt">Provider Management</h2></div>
                    <div class="table-card">
                        <div class="control-form">
                            <input type="text" id="providerSearch" placeholder="Search providers..." data-i18n="search_providers_ph" onkeyup="searchProviders()" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:6px;">
                        </div>
                        <div style="overflow-x:auto;">
                            <table class="providers-table">
                                <thead><tr><th data-i18n="name">Name</th><th data-i18n="type">Type</th><th data-i18n="email">Email</th><th data-i18n="status">Status</th><th data-i18n="actions">Actions</th></tr></thead>
                                <tbody id="providersTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="admin-bookings" class="admin-section">
                    <div class="section-header"><h2 data-i18n="all_bookings">All Bookings</h2></div>
                    <div class="table-card">
                        <div class="control-form">
                            <input type="text" id="bookingSearch" placeholder="Search bookings..." data-i18n="search_bookings_ph" onkeyup="searchBookings()" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:6px;">
                        </div>
                        <div style="overflow-x:auto;">
                            <table class="bookings-table">
                                <thead><tr><th data-i18n="customer">Customer</th><th data-i18n="provider">Provider</th><th data-i18n="service">Service</th><th data-i18n="date">Date</th><th data-i18n="status">Status</th><th data-i18n="actions">Actions</th></tr></thead>
                                <tbody id="bookingsTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="admin-submissions" class="admin-section">
                    <div class="section-header"><h2 data-i18n="user_probs_subs">User Problems & Submissions</h2></div>
                    <div class="table-card">
                        <div style="overflow-x:auto;">
                            <table class="submissions-table">
                                <thead><tr><th data-i18n="user">User</th><th data-i18n="category">Category</th><th data-i18n="date">Date</th><th data-i18n="status">Status</th><th data-i18n="actions">Actions</th></tr></thead>
                                <tbody id="submissionsTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="admin-news" class="admin-section">
                    <div class="section-header"><h2 data-i18n="manage_news">Manage News</h2></div>
                    
                    <div class="form-card" style="margin-bottom: 30px;">
                        <h4 style="margin-bottom:15px; color:#2e8b57;" data-i18n="add_news_item">Add New News Item</h4>
                        <form id="newsForm" onsubmit="addNewsItem(event)">
                            <div class="form-group"><input type="text" id="newsTitle" placeholder="News Title" data-i18n="news_title_ph" required></div>
                            <div class="form-group">
                                <select id="newsCategory" required>
                                    <option value="" data-i18n="select_category">Select Category</option>
                                    <option value="government" data-i18n="cat_govt_schemes">Government Schemes</option>
                                    <option value="regulations" data-i18n="cat_regulations">Regulations</option>
                                    <option value="health" data-i18n="cat_health">Health & Safety</option>
                                    <option value="agriculture" data-i18n="cat_agri">Agriculture</option>
                                    <option value="welfare" data-i18n="cat_welfare">Social Welfare</option>
                                </select>
                            </div>
                            <div class="form-group"><textarea id="newsContent" placeholder="News Content" data-i18n="news_content_ph" rows="3" required></textarea></div>
                            <div class="form-group"><input type="text" id="newsImage" placeholder="Image URL (optional)" data-i18n="img_url_ph"></div>
                            <button type="submit" class="submit-btn" data-i18n="pub_news_btn">Publish News</button>
                        </form>
                    </div>

                    <div class="table-card">
                        <h4 data-i18n="existing_news">Existing News Items</h4>
                        <div class="control-form" style="margin-top:10px;">
                            <input type="text" id="newsSearch" placeholder="Search news..." data-i18n="search_news_ph" onkeyup="searchNews()" style="width:100%; padding:10px; border:1px solid #ddd;">
                        </div>
                        <table class="submissions-table">
                            <thead><tr><th data-i18n="title">Title</th><th data-i18n="category">Category</th><th data-i18n="date">Date</th><th data-i18n="actions">Actions</th></tr></thead>
                            <tbody id="newsTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <div id="admin-reports" class="admin-section">
                    <div class="section-header"><h2 data-i18n="data_reports_gen">Data Reports Generation</h2></div>
                    
                    <div class="report-grid">
                        <div class="report-box">
                            <i class="fas fa-users fa-2x" style="color:#2e8b57; margin-bottom:15px;"></i>
                            <h4 data-i18n="users_report">Users Report</h4>
                            <p data-i18n="users_rep_desc">Generate a complete list of registered users and admins.</p>
                            <button class="report-btn" onclick="generateReport('users')" data-i18n="generate_btn">Generate</button>
                        </div>
                        <div class="report-box">
                            <i class="fas fa-calendar-check fa-2x" style="color:#2e8b57; margin-bottom:15px;"></i>
                            <h4 data-i18n="bookings_report">Bookings Report</h4>
                            <p data-i18n="bookings_rep_desc">Summary of all doctor and draftsman appointments.</p>
                            <button class="report-btn" onclick="generateReport('bookings')" data-i18n="generate_btn">Generate</button>
                        </div>
                        <div class="report-box">
                            <i class="fas fa-user-md fa-2x" style="color:#2e8b57; margin-bottom:15px;"></i>
                            <h4 data-i18n="providers_report">Providers Report</h4>
                            <p data-i18n="prov_rep_desc">List of all service providers and their approval status.</p>
                            <button class="report-btn" onclick="generateReport('providers')" data-i18n="generate_btn">Generate</button>
                        </div>
                    </div>

                    <div id="generatedReportArea" class="generated-report-area">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:2px solid #eee; padding-bottom:10px;">
                            <h3 id="reportTitle" style="color:#2e8b57;" data-i18n="report_title">Report</h3>
                            <button class="delete-btn action-btn" onclick="document.getElementById('generatedReportArea').style.display='none'" data-i18n="close_btn">Close</button>
                        </div>
                        <div id="reportContent" style="overflow-x:auto;"></div>
                        <div style="text-align:right; margin-top:20px;">
                            <button class="submit-btn" onclick="window.print()" style="width:auto; display:inline-block;"><i class="fas fa-print"></i> <span data-i18n="print_report">Print Report</span></button>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 data-i18n="app_title">LifeBridge Rural Sri Lanka</h3>
                    <p data-i18n="hero_desc_short">Bridging Sri Lankan Villages to Resources</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 data-i18n="quick_links">Quick Links</h3>
                    <ul>
                        <li><a href="#" onclick="showHome()" data-i18n="nav_home">Home</a></li>
                        <li><a href="#" onclick="showDashboard()" data-i18n="nav_dashboard">Dashboard</a></li>
                        <li><a href="#" onclick="showServiceProviders()" data-i18n="nav_providers">Service Providers</a></li>
                        <li><a href="#" data-i18n="nav_contact">Contact</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 data-i18n="govt_partners">Government Partners</h3>
                    <ul>
                        <li><a href="#">Ministry of Rural Economy</a></li>
                        <li><a href="#">Samurdhi Authority</a></li>
                        <li><a href="#">Agrarian Development</a></li>
                        <li><a href="#">Department of Agriculture</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 data-i18n="nav_providers">Service Providers</h3>
                    <ul>
                        <li><a href="#" onclick="showProviderSelectionModal()" data-i18n="register_provider">Register as Provider</a></li>
                        <li><a href="#" onclick="showProviderDashboard()" data-i18n="provider_login">Provider Login</a></li>
                        <li><a href="#" onclick="showAvailableDoctors()" data-i18n="find_doctors">Find Doctors</a></li>
                        <li><a href="#" onclick="showAvailableDraftsmen()" data-i18n="find_draftsmen">Find Draftsmen</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2025 LifeBridge Rural Sri Lanka. All rights reserved.</p>
            </div>
        </div>
    </footer>



<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
       (function(){
          emailjs.init("Lz97Kzo78hViJY56Z"); 
       })();
    </script>

    <script type="module">
        // 1. Firebase Library-ஐ Import செய்தல்
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, query, where, getDoc } 
            from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // 2. உங்கள் Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyC1b2ExyS8dwLXLfzL378IQX_wH-_Badrk",
            authDomain: "lifebridge-rural-d0c59.firebaseapp.com",
            projectId: "lifebridge-rural-d0c59",
            storageBucket: "lifebridge-rural-d0c59.firebasestorage.app",
            messagingSenderId: "762204012182",
            appId: "1:762204012182:web:49c3e4e7700016d927ccb7",
            measurementId: "G-6DW22Z82B5"
        };

        // 3. Firebase-ஐ Initialize செய்தல்
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Firebase மாறிகளை Window-ல் இணைத்தல் (Global Access-க்காக)
        window.db = db;

        console.log("Firebase Connected Successfully!");

        // --- தரவுகள் மற்றும் மொழிபெயர்ப்பு (Data & Translations) ---
        
        const translations = {
            en: {
                app_title: "LifeBridge Rural", nav_home: "Home", nav_dashboard: "Dashboard", nav_admin: "Admin", nav_providers: "Service Providers",
                nav_provider_dashboard: "Provider Dashboard", nav_contact: "Contact", login_btn: "Login",
                hero_title: "Bridging Sri Lankan Villages to Resources", hero_desc: "LifeBridge Rural is designed to act as a bridge between rural communities in Sri Lanka and the resources they need to thrive",
                hero_tagline: "\"Connecting rural Sri Lankan communities to opportunities, resources, and a brighter future\"",
                challenges_title: "Key Challenges for Rural Sri Lankan Communities",
                cat_govt_schemes: "Government Schemes & Financial Aid", cat_govt_desc: "Information on schemes like 'Gama Samaga Pilisandarak', 'Divi Neguma', and other rural development programs.",
                cat_regulations: "Government Regulations & Permissions", cat_reg_desc: "Guidance on obtaining permits for agriculture, small businesses, and housing in rural areas.",
                cat_health: "Health & Safety", cat_health_desc: "Access to information about rural health services, CKDu prevention, and maternal healthcare programs.",
                cat_agri: "Agriculture & Market", cat_agri_desc: "Support for tea, rubber, coconut, and spice farmers with market prices and modern techniques.",
                cat_welfare: "Social Welfare & Others", cat_welfare_desc: "Information on Samurdhi benefits, educational scholarships, and vocational training programs.",
                our_service_providers: "Our Service Providers", providers_intro: "Connect with certified professionals who can help you with your specific needs. All providers are verified by our admin team.",
                medical_services: "Medical Services", medical_services_desc: "Book appointments with certified doctors specializing in various fields. Get medical consultations and health advice.",
                view_doctors: "View Available Doctors", book_doctor: "Book a Doctor",
                draftsman_services: "Draftsman Services", draftsman_services_desc: "Get professional drafting services for construction plans, site plans, and architectural drawings for your projects.",
                view_draftsmen: "View Available Draftsmen", book_draftsman: "Book a Draftsman",
                news_title: "Latest News & Updates", all_news: "All News",
                welcome_dashboard: "Welcome to Your Dashboard", dashboard_desc: "Manage your profile and submit your problems for assistance",
                personal_info: "Personal Information", submit_problem: "Submit Your Problem", your_bookings: "Your Bookings",
                browse_solutions: "Browse Solutions by Category", login_title: "Login to Your Account", login_desc: "Enter your credentials to access the portal",
                email_label: "Email Address", password_label: "Password", role_label: "Login As", no_account: "Don't have an account?",
                signup_link: "Sign up here", is_provider: "Are you a service provider?", register_link: "Register here",
                create_account: "Create an Account", join_message: "Join LifeBridge Rural to access resources", full_name: "Full Name",
                confirm_password: "Confirm Password", create_account_btn: "Create Account", have_account: "Already have an account?",
                login_link: "Login here", register_provider: "Register as Service Provider", select_profession: "Select your profession to register",
                doctor: "Doctor", doctor_desc: "Medical professional providing healthcare services", draftsman: "Draftsman",
                draftsman_desc: "Technical drawing specialist for construction plans", choose_pic: "Choose Profile Picture",
                phone_number: "Phone Number", address: "Address", district: "District", pradeshiya_sabha: "Pradeshiya Sabha",
                bio: "Professional Bio", submit_reg: "Submit Registration", quick_links: "Quick Links", govt_partners: "Government Partners",
                provider_login: "Provider Login", find_doctors: "Find Doctors", find_draftsmen: "Find Draftsmen",
                select_role: "Select Role", role_user: "User", role_doctor: "Doctor", role_draftsman: "Draftsman", role_admin: "Admin",
                name_placeholder: "Enter full name", email_placeholder: "Enter email", password_placeholder: "Enter password",
                create_password_placeholder: "Create password", confirm_password_placeholder: "Confirm password",
                phone_placeholder: "Enter phone number", address_placeholder: "Enter address", bio_placeholder: "Tell us about yourself",
                terms_certify: "I certify that all information provided is accurate", submit_reg: "Submit Registration",
                prob_submit_title: "Problem Submission", prob_submit_desc: "Details about the problem",
                booking_details_title: "Booking Details", booking_details_desc: "Details of the booking",
                your_response: "Your Response", response_placeholder: "Type your response...", submit_response: "Submit Response",
                mark_completed: "Mark Completed", provider_response_title: "Provider Response", provider_response_desc: "Response details",
                select_district: "Select District", select_pradeshiya: "Select Pradeshiya Sabha",
                update_info_btn: "Update Information", submit_prob_btn: "Submit Problem", prob_category: "Category",
                prob_title: "Problem Title", prob_title_placeholder: "Title", prob_desc: "Description", prob_desc_placeholder: "Description",
                location_village: "Location", loc_placeholder: "Village Name", contact_num: "Contact Number", contact_placeholder: "Contact",
                select_category: "Select Category", patient_name: "Patient Name", patient_age: "Age", patient_gender: "Gender",
                medical_issue: "Medical Issue", pref_date: "Preferred Date", pref_time: "Preferred Time", add_notes: "Notes",
                book_appoint_btn: "Book Appointment", cancel_btn: "Cancel", select_doctor: "Select Doctor", select_draftsman: "Select Draftsman",
                client_name: "Client Name", project_type: "Project Type", project_details: "Project Details", prop_address: "Property Address",
                prop_size: "Property Size", site_visit_date: "Site Visit Date", budget_est: "Budget Estimate", book_draftsman_btn: "Book Draftsman",
                contact_title: "Contact Us", provider_dash_title: "Provider Dashboard", provider_dash_desc: "Manage profile and bookings",
                welcome: "Welcome", logged_in_as: "You are logged in as", contact_info: "Contact Info", bio_will_appear: "Bio here",
                my_bookings: "My Bookings", my_profile: "My Profile", availability: "Availability", update_profile: "Update Profile",
                update_profile_btn: "Update Profile", manage_avail: "Manage Availability", curr_status: "Current Status",
                mark_avail: "Available", mark_busy: "Busy", mark_unavail: "Unavailable", upcoming_bookings: "Upcoming Bookings",
                customer: "Customer", service_type: "Service", date: "Date", status: "Status", actions: "Actions",
                hospital_clinic: "Hospital/Clinic", avail_placeholder: "e.g., Mon-Fri 9am-5pm", consult_fee: "Fee (LKR)", fee_placeholder: "Amount",
                services_offered: "Services", services_placeholder: "List services", service_rate: "Rate", rate_placeholder: "e.g., 5000",
                admin_panel_title: "Admin Panel", admin_overview: "Overview", admin_users: "Users", admin_providers: "Providers",
                admin_bookings: "Bookings", admin_problems: "Problems", admin_news: "News", admin_reports: "Reports",
                dash_overview: "Dashboard Overview", total_users: "Total Users", total_bookings: "Total Bookings", pending_approvals: "Pending Approvals",
                user_mgmt: "User Management", search_users_ph: "Search users...", name: "Name", email: "Email", role: "Role",
                provider_mgmt: "Provider Management", search_providers_ph: "Search providers...", type: "Type",
                all_bookings: "All Bookings", search_bookings_ph: "Search bookings...", provider: "Provider", service: "Service",
                user_probs_subs: "User Problems", user: "User", category: "Category",
                manage_news: "Manage News", add_news_item: "Add News", news_title_ph: "News Title", news_content_ph: "Content",
                img_url_ph: "Image URL", pub_news_btn: "Publish", existing_news: "Existing News", search_news_ph: "Search news...",
                title: "Title", data_reports_gen: "Reports", users_report: "Users Report", users_rep_desc: "Registered users list",
                bookings_report: "Bookings Report", bookings_rep_desc: "All bookings", providers_report: "Providers Report",
                prov_rep_desc: "Service providers list", generate_btn: "Generate", report_title: "Report", close_btn: "Close", print_report: "Print"
            },
            si: {
                app_title: "ලයිෆ් බ්‍රිජ් ග්‍රාමීය", nav_home: "මුල් පිටුව", nav_dashboard: "පුවරුව", nav_admin: "පරිපාලක",
                nav_providers: "සේවා සපයන්නන්", login_btn: "පිවිසෙන්න", hero_title: "ශ්‍රී ලංකා ගම්මාන සම්පත් වෙත",
                // (Sinhala translations truncated for brevity, but logic remains for keys provided above)
            }
        };

        const pradeshiyaSabhasData = {
            "Ampara": ["Akkaraipattu", "Ampara", "Dehiattakandiya", "Kalmunai", "Mahaoya", "Padiyatalawa", "Sammanthurai", "Uhana"],
            "Anuradhapura": ["Anuradhapura", "Galenbindunuwewa", "Horowpathana", "Kahatagasdigiliya", "Kekirawa", "Medawachchiya", "Mihintale", "Nochchiyagama", "Padaviya", "Palagala", "Talawa"],
            "Badulla": ["Badulla", "Bandarawela", "Ella", "Haldummulla", "Hali-Ela", "Haputale", "Mahiyanganaya", "Meegahakiula", "Passara", "Welimada"],
            "Batticaloa": ["Eravur Pattu", "Koralai Pattu", "Manmunai", "Porativu Pattu"],
            "Colombo": ["Colombo", "Dehiwala-Mount Lavinia", "Homagama", "Kaduwela", "Kesbewa", "Kolonnawa", "Kotte", "Maharagama", "Moratuwa", "Ratmalana", "Seethawaka"],
            "Galle": ["Akmeemana", "Ambalangoda", "Baddegama", "Bentota", "Bope-Poddala", "Elpitiya", "Galle", "Habaraduwa", "Imaduwa", "Karandeniya", "Nagoda", "Neluwa", "Niyagama", "Thawalama"],
            "Gampaha": ["Attanagalla", "Biyagama", "Divulapitiya", "Dompe", "Gampaha", "Ja-Ela", "Katana", "Kelaniya", "Mahara", "Minuwangoda", "Mirigama", "Negombo", "Wattala"],
            "Hambantota": ["Ambalantota", "Angunakolapelessa", "Beliatta", "Hambantota", "Lunugamvehera", "Sooriyawewa", "Tangalle", "Tissamaharama", "Weeraketiya"],
            "Jaffna": ["Chavakachcheri", "Delft", "Jaffna", "Karainagar", "Kayts", "Nallur", "Point Pedro", "Valikamam", "Velanai"],
            "Kalutara": ["Agalawatta", "Bandaragama", "Beruwala", "Bulathsinhala", "Dodangoda", "Horana", "Kalutara", "Madurawela", "Matugama", "Panadura", "Walallawita"],
            "Kandy": ["Akurana", "Gangawata Korale", "Harispattuwa", "Kandy", "Kundasale", "Meda Dumbara", "Minipe", "Panvila", "Pasbage Korale", "Pathadumbara", "Poojapitiya", "Thumpane", "Uda Palatha", "Udunuwara", "Yatinuwara"],
            "Kegalle": ["Aranayake", "Bulathkohupitiya", "Dehiowita", "Deraniyagala", "Galigamuwa", "Kegalle", "Mawanella", "Rambukkana", "Ruwanwella", "Warakapola", "Yatiyantota"],
            "Kilinochchi": ["Karachchi", "Pachchilaipalli", "Poonakary"],
            "Kurunegala": ["Alawwa", "Bingiriya", "Galgamuwa", "Giribawa", "Ibbagamuwa", "Kobeigane", "Kuliyapitiya", "Kurunegala", "Mawathagama", "Narammala", "Nikaweratiya", "Panduwasnuwara", "Polgahawela", "Polpithigama", "Wariyapola"],
            "Mannar": ["Mannar", "Manthai West", "Musali", "Nanaddan"],
            "Matale": ["Ambanganga Korale", "Dambulla", "Galewela", "Laggala-Pallegama", "Matale", "Naula", "Pallepola", "Rattota", "Ukuwela", "Wilgamuwa", "Yatawatta"],
            "Matara": ["Akuressa", "Athuraliya", "Devinuwara", "Dickwella", "Hakmana", "Kamburupitiya", "Kirinda Puhulwella", "Kotapola", "Malimbada", "Matara", "Mulatiyana", "Pasgoda", "Pitabeddara", "Thihagoda", "Weligama"],
            "Moneragala": ["Badalkumbura", "Bibile", "Buttala", "Kataragama", "Madulla", "Medagama", "Moneragala", "Siyambalanduwa", "Thanamalvila", "Wellawaya"],
            "Mullaitivu": ["Manthai East", "Maritimepattu", "Puthukudiyiruppu", "Thunukkai"],
            "Nuwara Eliya": ["Ambagamuwa", "Hanguranketha", "Kothmale", "Nuwara Eliya", "Walapane"],
            "Polonnaruwa": ["Dimbulagala", "Elahera", "Hingurakgoda", "Lankapura", "Medirigiriya", "Polonnaruwa", "Welikanda"],
            "Puttalam": ["Anamaduwa", "Arachchikattuwa", "Chilaw", "Kalpitiya", "Karuwalagaswewa", "Nattandiya", "Nawagattegama", "Puttalam", "Wennappuwa"],
            "Ratnapura": ["Ayagama", "Balangoda", "Eheliyagoda", "Elapattha", "Embilipitiya", "Godakawela", "Imbulpe", "Kahawatta", "Kalawana", "Kolonna", "Kuruwita", "Nivithigala", "Opanayaka", "Pelmadulla", "Ratnapura", "Weligepola"],
            "Trincomalee": ["Gomarankadawala", "Kantalai", "Kinniya", "Kuchchaveli", "Morawewa", "Muttur", "Padavi Sri Pura", "Seruwila", "Thambalagamuwa", "Trincomalee"],
            "Vavuniya": ["Vavuniya", "Vavuniya North", "Vavuniya South", "Vengalacheddikulam"]
        };

        // --- GLOBAL FUNCTION EXPORTS (விடுபடாமல் இருக்க) ---
        // module scope-ல் இருந்து window object-க்கு functions-ஐ மாற்றுகிறோம்.
        window.changeLanguage = changeLanguage;
        window.loadPradeshiyaSabhasForProvider = loadPradeshiyaSabhasForProvider;
        window.closeAuthModal = closeAuthModal;
        window.closeProviderModal = closeProviderModal;
        window.closeProviderRegistrationModal = closeProviderRegistrationModal;
        window.closeBookingDetailsModal = closeBookingDetailsModal;
        window.closeResponseModal = closeResponseModal;
        window.closeSubmissionModal = closeSubmissionModal;
        
        window.showHome = showHome;
        window.showServiceProviders = showServiceProviders;
        window.showServiceProvidersPage = showServiceProvidersPage;
        window.showContact = showContact;
        window.showDashboard = showDashboard;
        window.showProviderDashboard = showProviderDashboard;
        window.showAdminPanel = showAdminPanel;
        
        window.showLoginModal = showLoginModal;
        window.showSignupModal = showSignupModal;
        window.showProviderSelectionModal = showProviderSelectionModal;
        window.showProviderRegistrationForm = showProviderRegistrationForm;
        
        // Form Handlers (Async)
        window.handleLogin = handleLogin;
        window.handleSignup = handleSignup;
        window.handleProviderRegistration = handleProviderRegistration;
        window.handleLogout = handleLogout;
        window.handleProviderLogout = handleProviderLogout;
        window.updatePersonalInfo = updatePersonalInfo;
        window.submitProblemForm = submitProblemForm;
        window.submitDoctorBooking = submitDoctorBooking;
        window.submitDraftsmanBooking = submitDraftsmanBooking;
        window.updateProviderProfile = updateProviderProfile;
        window.submitProviderResponse = submitProviderResponse;
        window.markBookingAsCompleted = markBookingAsCompleted;
        window.addNewsItem = addNewsItem;

        // UI Interactions
        window.changeAvailabilityStatus = changeAvailabilityStatus;
        window.cancelBooking = cancelBooking;
        window.showAvailableDoctors = showAvailableDoctors;
        window.showAvailableDraftsmen = showAvailableDraftsmen;
        window.bookDoctor = bookDoctor;
        window.bookDraftsman = bookDraftsman;
        window.bookDoctorWithId = bookDoctorWithId;
        window.bookDraftsmanWithId = bookDraftsmanWithId;
        window.viewUserBooking = viewUserBooking;
        window.viewProviderBooking = viewProviderBooking;
        window.viewProviderResponse = viewProviderResponse;
        window.respondToBooking = respondToBooking;
        window.switchProviderTab = switchProviderTab;
        window.switchAdminSection = switchAdminSection;
        window.generateReport = generateReport;
        window.navigateToCategory = navigateToCategory;
        
        // Search & Filter
        window.searchUsers = searchUsers;
        window.searchProviders = searchProviders;
        window.searchBookings = searchBookings;
        window.searchNews = searchNews;
        
        // Actions
        window.editUser = editUser;
        window.deleteUser = deleteUser;
        window.approveProvider = approveProvider;
        window.rejectProvider = rejectProvider;
        window.viewProvider = viewProvider;
        window.deleteProvider = deleteProvider;
        window.viewAdminBooking = viewAdminBooking;
        window.deleteAdminBooking = deleteAdminBooking;
        window.viewSubmission = viewSubmission;
        window.deleteSubmission = deleteSubmission;
        window.editNews = editNews;
        window.deleteNews = deleteNews;
        window.viewFullNews = viewFullNews;

        // --- HELPER FUNCTIONS ---

        function changeLanguage(lang) {
            localStorage.setItem('preferredLanguage', lang);
            const selectedLang = translations[lang] || translations['en'];
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (selectedLang[key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = selectedLang[key];
                    } else if(element.children.length > 0 && element.tagName !== 'BUTTON') {
                        // Skip complex structures if needed, or target text nodes
                        // For simplicity, we skip if complex
                    } else {
                        element.innerText = selectedLang[key];
                    }
                }
            });
            const selector = document.querySelector('.lang-select');
            if(selector) selector.value = lang;
        }

        function loadPradeshiyaSabhasForProvider() {
            const districtSelect = document.getElementById('providerDistrict');
            const districtRaw = districtSelect.value;
            const district = districtRaw.charAt(0).toUpperCase() + districtRaw.slice(1); // Ensure case matches data
            const pradeshiyaSabhaSelect = document.getElementById('providerPradeshiyaSabha');
            
            pradeshiyaSabhaSelect.innerHTML = '<option value="">Select Pradeshiya Sabha</option>';
            
            if (district && pradeshiyaSabhasData[district]) {
                pradeshiyaSabhasData[district].forEach(sabha => {
                    const option = document.createElement("option");
                    option.value = sabha;
                    option.textContent = sabha;
                    pradeshiyaSabhaSelect.appendChild(option);
                });
            } else {
                const option = document.createElement("option");
                option.value = "Other";
                option.textContent = "Other (Please specify)";
                pradeshiyaSabhaSelect.appendChild(option);
            }
        }

        function getSpecializationName(code) {
            const specializations = { 'general': 'General Practitioner', 'pediatrics': 'Pediatrics', 'gynecology': 'Gynecology', 'cardiology': 'Cardiology', 'dermatology': 'Dermatology', 'orthopedics': 'Orthopedics', 'psychiatry': 'Psychiatry', 'dentistry': 'Dentistry' };
            return specializations[code] || code;
        }

        function hideAllPages() {
            const sections = ['homeContent', 'userDashboard', 'providerDashboard', 'adminPanel', 'serviceProvidersSection', 'contactPage'];
            sections.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.style.display = 'none';
            });
            // Close all modals
            document.querySelectorAll('.auth-modal, .provider-modal, .submission-modal, .booking-details-modal, .response-modal').forEach(m => m.style.display = 'none');
        }

        function toggleFooter(show) {
            const footer = document.querySelector('footer');
            if (footer) footer.style.display = show ? 'block' : 'none';
        }

        function updateUserInterface() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            const currentProvider = JSON.parse(localStorage.getItem('currentProvider') || 'null');
            const authButton = document.getElementById('authButton');
            const userProfileSection = document.getElementById('userProfileSection');
            const userName = document.getElementById('userName');
            const userAvatar = document.getElementById('userAvatar');

            if (currentUser) {
                authButton.textContent = 'Logout';
                authButton.onclick = handleLogout;
                userProfileSection.style.display = 'flex';
                userName.textContent = currentUser.name;
                userAvatar.src = currentUser.profilePicture || `https://ui-avatars.com/api/?name=${currentUser.name}&background=2e8b57&color=fff`;
            } else if (currentProvider) {
                authButton.textContent = 'Logout';
                authButton.onclick = handleProviderLogout;
                userProfileSection.style.display = 'flex';
                userName.textContent = currentProvider.name;
                userAvatar.src = currentProvider.profilePicture || `https://ui-avatars.com/api/?name=${currentProvider.name}&background=2e8b57&color=fff`;
            } else {
                authButton.textContent = 'Login';
                authButton.onclick = showLoginModal;
                userProfileSection.style.display = 'none';
            }
        }

        // --- AUTHENTICATION (FIREBASE) ---

        async function handleSignup(event) {
            event.preventDefault();
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const profilePictureInput = document.getElementById('profilePicture');

            if (password !== confirmPassword) { alert("Passwords do not match"); return; }

            try {
                const q = query(collection(db, "users"), where("email", "==", email));
                const snap = await getDocs(q);
                if (!snap.empty) { alert("Email already exists"); return; }

                let profilePicUrl = `https://ui-avatars.com/api/?name=${name}&background=2e8b57&color=fff`;
                if (profilePictureInput.files.length > 0) {
                    const reader = new FileReader();
                    reader.readAsDataURL(profilePictureInput.files[0]);
                    await new Promise(r => reader.onload = () => { profilePicUrl = reader.result; r(); });
                }

                const newUser = {
                    name, email, password, role: 'user', 
                    profilePicture: profilePicUrl,
                    joinDate: new Date().toISOString().split('T')[0], status: 'Active'
                };

                const docRef = await addDoc(collection(db, "users"), newUser);
                const userWithId = { ...newUser, id: docRef.id };
                localStorage.setItem('currentUser', JSON.stringify(userWithId));
                
                closeAuthModal();
                updateUserInterface();
                showDashboard();
                document.getElementById('signupForm').reset();
                alert("Account created successfully!");
            } catch (error) {
                console.error(error); alert("Signup Error: " + error.message);
            }
        }

        async function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const role = document.getElementById('loginRole').value;

            try {
                let q;
                if (role === 'user' || role === 'admin') {
                    q = query(collection(db, "users"), where("email", "==", email), where("password", "==", password), where("role", "==", role));
                } else {
                    q = query(collection(db, "serviceProviders"), where("email", "==", email), where("password", "==", password), where("type", "==", role), where("status", "==", "approved"));
                }

                const querySnapshot = await getDocs(q);
                if (!querySnapshot.empty) {
                    const docData = querySnapshot.docs[0];
                    const user = { ...docData.data(), id: docData.id };
                    
                    if (role === 'doctor' || role === 'draftsman') {
                        localStorage.setItem('currentProvider', JSON.stringify(user));
                        localStorage.removeItem('currentUser');
                        showProviderDashboard();
                    } else {
                        localStorage.setItem('currentUser', JSON.stringify(user));
                        localStorage.removeItem('currentProvider');
                        if (role === 'admin') showAdminPanel();
                        else showDashboard();
                    }

                    closeAuthModal();
                    updateUserInterface();
                    document.getElementById('loginForm').reset();
                } else {
                    alert("Invalid credentials or account not active.");
                }
            } catch (error) {
                console.error("Login Error", error);
                alert("Login Failed: " + error.message);
            }
        }

        async function handleProviderRegistration(event) {
            event.preventDefault();
            const type = document.getElementById('providerType').value;
            const email = document.getElementById('providerEmail').value.trim();
            const password = document.getElementById('providerPassword').value;
            const confirmPassword = document.getElementById('providerConfirmPassword').value;

            if (password !== confirmPassword) { alert("Passwords do not match"); return; }
            if (!document.getElementById('providerTerms').checked) { alert("Accept terms"); return; }

            try {
                // Check if email exists in both collections
                const q1 = query(collection(db, "serviceProviders"), where("email", "==", email));
                const s1 = await getDocs(q1);
                const q2 = query(collection(db, "users"), where("email", "==", email));
                const s2 = await getDocs(q2);
                
                if (!s1.empty || !s2.empty) { alert("Email already exists"); return; }

                let picUrl = `https://ui-avatars.com/api/?name=${document.getElementById('providerName').value}&background=2e8b57&color=fff`;
                const picInput = document.getElementById('providerProfilePicture');
                if (picInput.files.length > 0) {
                    const reader = new FileReader();
                    reader.readAsDataURL(picInput.files[0]);
                    await new Promise(r => reader.onload = () => { picUrl = reader.result; r(); });
                }

                const providerData = {
                    type,
                    name: document.getElementById('providerName').value.trim(),
                    email, password,
                    phone: document.getElementById('providerPhone').value.trim(),
                    address: document.getElementById('providerAddress').value.trim(),
                    district: document.getElementById('providerDistrict').value,
                    pradeshiyaSabha: document.getElementById('providerPradeshiyaSabha').value,
                    bio: document.getElementById('providerBio').value.trim(),
                    status: 'pending', availabilityStatus: 'available',
                    joinDate: new Date().toISOString().split('T')[0],
                    profilePicture: picUrl
                };

                if(type === 'doctor') {
                    providerData.hospital = document.getElementById('doctorHospital').value;
                    providerData.specialization = document.getElementById('doctorSpecialization').value;
                    providerData.consultationFee = document.getElementById('doctorConsultationFee').value;
                    providerData.availability = document.getElementById('doctorAvailability').value;
                    providerData.qualification = document.getElementById('doctorQualification').value;
                    providerData.registrationNo = document.getElementById('doctorRegistrationNo').value;
                    providerData.experience = document.getElementById('doctorExperience').value;
                } else {
                    providerData.services = document.getElementById('draftsmanServices').value;
                    providerData.rate = document.getElementById('draftsmanRate').value;
                    providerData.availability = document.getElementById('draftsmanAvailability').value;
                    providerData.qualification = document.getElementById('draftsmanQualification').value;
                    providerData.registrationNo = document.getElementById('draftsmanRegistrationNo').value;
                    providerData.experience = document.getElementById('draftsmanExperience').value;
                }

                await addDoc(collection(db, "serviceProviders"), providerData);
                document.getElementById('providerRegistrationModal').style.display = 'none';
                document.getElementById('providerRegistrationForm').reset();
                alert("Registration successful! Wait for admin approval.");
            } catch (e) {
                console.error(e); alert("Registration failed: " + e.message);
            }
        }

        // --- DASHBOARD FUNCTIONS ---

        async function updatePersonalInfo(event) {
            event.preventDefault();
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;
            
            const updatedData = {
                name: document.getElementById('personalName').value,
                phone: document.getElementById('personalPhone').value,
                address: document.getElementById('personalAddress').value,
                district: document.getElementById('personalDistrict').value,
                pradeshiyaSabha: document.getElementById('personalPradeshiyaSabha').value
            };

            try {
                const userRef = doc(db, "users", currentUser.id);
                await updateDoc(userRef, updatedData);
                
                // Update local session
                localStorage.setItem('currentUser', JSON.stringify({ ...currentUser, ...updatedData }));
                updateUserInterface();
                alert('Profile updated successfully!');
            } catch (e) {
                console.error(e); alert("Update failed.");
            }
        }

        async function submitProblemForm(event) {
            event.preventDefault();
            const u = JSON.parse(localStorage.getItem('currentUser'));
            if (!u) { alert('Login required'); showLoginModal(); return; }

            const data = {
                userId: u.id, userName: u.name, userEmail: u.email,
                category: document.getElementById('problemCategory').value,
                title: document.getElementById('problemTitle').value,
                description: document.getElementById('problemDescription').value,
                location: document.getElementById('problemLocation').value,
                contact: document.getElementById('problemContact').value,
                date: new Date().toISOString().split('T')[0], status: 'Pending'
            };

            // EmailJS Integration
            emailjs.send("service_704wqwt", "template_58tn5v9", {
                to_name: "Admin", from_name: data.userName, from_email: data.userEmail,
                category: data.category, message: `Title: ${data.title}\nDesc: ${data.description}`
            }, "Lz97Kzo78hViJY56Z").then(() => console.log("Email sent"), (e) => console.error(e));

            try {
                await addDoc(collection(db, "submissions"), data);
                document.getElementById('problemForm').reset();
                alert('Problem submitted successfully!');
            } catch(e) { console.error(e); alert("Submission failed."); }
        }

        // --- BOOKING LOGIC ---

        async function loadAvailableProviders() {
            const dSelect = document.getElementById('bookingDoctor');
            const drSelect = document.getElementById('bookingDraftsman');
            const dList = document.getElementById('doctorsList');
            const drList = document.getElementById('draftsmenList');
            
            dSelect.innerHTML = '<option value="">Select Doctor</option>';
            drSelect.innerHTML = '<option value="">Select Draftsman</option>';
            dList.innerHTML = ''; drList.innerHTML = '';

            try {
                const q = query(collection(db, "serviceProviders"), where("status", "==", "approved"));
                const snap = await getDocs(q);

                if(snap.empty) {
                     dList.innerHTML = '<p>No providers.</p>';
                     drList.innerHTML = '<p>No providers.</p>';
                     return;
                }

                snap.forEach(doc => {
                    const p = { ...doc.data(), id: doc.id };
                    if(p.type === 'doctor') {
                        const opt = document.createElement('option'); opt.value = p.id; opt.textContent = `${p.name} - ${p.hospital}`;
                        dSelect.appendChild(opt);
                        dList.innerHTML += `<div class="category-card"><div class="category-icon"><i class="fas fa-user-md"></i></div><div class="category-content"><h3>${p.name}</h3><p>${p.specialization}</p><p>Fee: ${p.consultationFee}</p><button class="read-more-btn" onclick="bookDoctorWithId('${p.id}')">Book</button></div></div>`;
                    } else {
                        const opt = document.createElement('option'); opt.value = p.id; opt.textContent = p.name;
                        drSelect.appendChild(opt);
                        drList.innerHTML += `<div class="category-card"><div class="category-icon"><i class="fas fa-ruler-combined"></i></div><div class="category-content"><h3>${p.name}</h3><p>Rate: ${p.rate}</p><button class="read-more-btn" onclick="bookDraftsmanWithId('${p.id}')">Book</button></div></div>`;
                    }
                });
            } catch(e) { console.error(e); }
        }

        async function submitDoctorBooking(event) {
            event.preventDefault();
            const u = JSON.parse(localStorage.getItem('currentUser'));
            if(!u) { showLoginModal(); return; }
            
            const docId = document.getElementById('bookingDoctor').value;
            const sel = document.getElementById('bookingDoctor');
            const pName = sel.options[sel.selectedIndex].text.split(' - ')[0];

            const booking = {
                userId: u.id, userName: u.name, userEmail: u.email,
                providerId: docId, providerName: pName, type: 'doctor',
                patientName: document.getElementById('patientName').value,
                patientAge: document.getElementById('patientAge').value,
                patientGender: document.getElementById('patientGender').value,
                medicalIssue: document.getElementById('medicalIssue').value,
                preferredDate: document.getElementById('preferredDate').value,
                preferredTime: document.getElementById('preferredTime').value,
                contact: document.getElementById('bookingContact').value,
                notes: document.getElementById('bookingNotes').value,
                status: 'pending', bookingDate: new Date().toISOString().split('T')[0]
            };

            try {
                await addDoc(collection(db, "bookings"), booking);
                document.getElementById('doctorBookingFormContent').reset();
                alert("Appointment booked!");
                cancelBooking();
            } catch(e) { console.error(e); alert("Booking failed"); }
        }

        async function submitDraftsmanBooking(event) {
            event.preventDefault();
            const u = JSON.parse(localStorage.getItem('currentUser'));
            if(!u) { showLoginModal(); return; }
            
            const dId = document.getElementById('bookingDraftsman').value;
            const sel = document.getElementById('bookingDraftsman');
            const pName = sel.options[sel.selectedIndex].text;

            const booking = {
                userId: u.id, userName: u.name, userEmail: u.email,
                providerId: dId, providerName: pName, type: 'draftsman',
                clientName: document.getElementById('clientName').value,
                projectType: document.getElementById('projectType').value,
                projectDetails: document.getElementById('projectDetails').value,
                propertyAddress: document.getElementById('propertyAddress').value,
                propertySize: document.getElementById('propertySize').value,
                preferredVisitDate: document.getElementById('preferredVisitDate').value,
                contact: document.getElementById('draftsmanContact').value,
                budget: document.getElementById('draftsmanBudget').value,
                status: 'pending', bookingDate: new Date().toISOString().split('T')[0]
            };

            try {
                await addDoc(collection(db, "bookings"), booking);
                document.getElementById('draftsmanBookingFormContent').reset();
                alert("Service booked!");
                cancelBooking();
            } catch(e) { console.error(e); alert("Booking failed"); }
        }

        // --- LOADING LISTS (USER & PROVIDER) ---

        async function loadUserBookings() {
            const u = JSON.parse(localStorage.getItem('currentUser'));
            if(!u) return;
            const div = document.getElementById('userBookingsList');
            div.innerHTML = '<p>Loading...</p>';

            try {
                const q = query(collection(db, "bookings"), where("userId", "==", u.id));
                const snap = await getDocs(q);
                if(snap.empty) { div.innerHTML = '<p>No bookings found.</p>'; return; }

                let html = '<table class="provider-bookings-table"><thead><tr><th>Provider</th><th>Type</th><th>Date</th><th>Status</th><th>Action</th></tr></thead><tbody>';
                snap.forEach(doc => {
                    const b = doc.data();
                    html += `<tr><td>${b.providerName}</td><td>${b.type}</td><td>${b.preferredDate || b.bookingDate}</td>
                    <td><span class="status-badge status-${b.status}">${b.status}</span></td>
                    <td><button class="action-btn view-btn" onclick="viewUserBooking('${doc.id}')">View</button></td></tr>`;
                });
                div.innerHTML = html + '</tbody></table>';
            } catch(e) { console.error(e); div.innerHTML = '<p>Error.</p>'; }
        }

        async function loadProviderBookings(pid) {
            const tbody = document.getElementById('providerBookingsTableBody');
            tbody.innerHTML = '<tr><td>Loading...</td></tr>';
            try {
                const q = query(collection(db, "bookings"), where("providerId", "==", pid));
                const snap = await getDocs(q);
                if(snap.empty) { tbody.innerHTML = '<tr><td>No bookings.</td></tr>'; return; }

                let html = '';
                snap.forEach(doc => {
                    const b = doc.data();
                    html += `<tr><td>${b.userName || b.clientName}</td><td>${b.type}</td><td>${b.preferredDate || b.bookingDate}</td>
                    <td>${b.status}</td><td><button class="action-btn view-btn" onclick="viewProviderBooking('${doc.id}')">View</button></td></tr>`;
                });
                tbody.innerHTML = html;
            } catch(e) { console.error(e); }
        }

        // --- ADMIN PANEL TABLES ---

        async function loadUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '<tr><td>Loading...</td></tr>';
            const snap = await getDocs(collection(db, "users"));
            let html = '';
            snap.forEach(doc => {
                const u = doc.data();
                html += `<tr><td>${u.name}</td><td>${u.email}</td><td>${u.role}</td>
                <td><button class="action-btn delete-btn" onclick="deleteUser('${doc.id}')">Delete</button></td></tr>`;
            });
            tbody.innerHTML = html || '<tr><td>No users</td></tr>';
        }

        async function loadProvidersTable() {
            const tbody = document.getElementById('providersTableBody');
            tbody.innerHTML = '<tr><td>Loading...</td></tr>';
            const snap = await getDocs(collection(db, "serviceProviders"));
            let html = '';
            snap.forEach(doc => {
                const p = doc.data();
                html += `<tr><td>${p.name}</td><td>${p.type}</td><td>${p.status}</td>
                <td>
                    ${p.status === 'pending' ? `
                    <button class="action-btn approve-btn" onclick="updateProviderStatusFirebase('${doc.id}', 'approved')">Approve</button>
                    <button class="action-btn reject-btn" onclick="updateProviderStatusFirebase('${doc.id}', 'rejected')">Reject</button>` : ''}
                    <button class="action-btn delete-btn" onclick="deleteProviderFirebase('${doc.id}')">Delete</button>
                </td></tr>`;
            });
            tbody.innerHTML = html || '<tr><td>No providers</td></tr>';
        }

        async function loadBookingsTable() {
            const tbody = document.getElementById('bookingsTableBody');
            tbody.innerHTML = '<tr><td>Loading...</td></tr>';
            const snap = await getDocs(collection(db, "bookings"));
            let html = '';
            snap.forEach(doc => {
                const b = doc.data();
                html += `<tr><td>${b.userName}</td><td>${b.providerName}</td><td>${b.status}</td>
                <td><button class="action-btn delete-btn" onclick="deleteBookingFirebase('${doc.id}')">Delete</button></td></tr>`;
            });
            tbody.innerHTML = html || '<tr><td>No bookings</td></tr>';
        }

        async function loadSubmissionsTable() {
            const tbody = document.getElementById('submissionsTableBody');
            const snap = await getDocs(collection(db, "submissions"));
            let html = '';
            snap.forEach(doc => {
                const s = doc.data();
                html += `<tr><td>${s.userName}</td><td>${s.category}</td><td>${s.date}</td><td>${s.status}</td>
                <td><button class="action-btn delete-btn" onclick="deleteSubmission('${doc.id}')">Delete</button></td></tr>`;
            });
            tbody.innerHTML = html;
        }

        async function loadNewsTable() {
            const tbody = document.getElementById('newsTableBody');
            const grid = document.getElementById('newsGrid');
            const snap = await getDocs(collection(db, "news"));
            
            let tableHtml = ''; let gridHtml = '';
            snap.forEach(doc => {
                const n = doc.data();
                // Admin Table
                if(tbody) tableHtml += `<tr><td>${n.title}</td><td>${n.category}</td><td><button class="action-btn delete-btn" onclick="deleteNews('${doc.id}')">Delete</button></td></tr>`;
                // Public Grid
                if(grid) gridHtml += `<div class="news-card"><div class="news-image"><img src="${n.image}" onerror="this.src='https://via.placeholder.com/300'"></div><div class="news-content"><h3>${n.title}</h3><p>${n.content.substring(0,60)}...</p><span class="news-date">${n.date}</span></div></div>`;
            });
            if(tbody) tbody.innerHTML = tableHtml;
            if(grid) grid.innerHTML = gridHtml || '<p class="no-news">No news available.</p>';
        }

        // --- HELPER WRAPPERS (for Admin Actions) ---
        window.updateProviderStatusFirebase = async function(id, status) {
            await updateDoc(doc(db, "serviceProviders", id), { status });
            loadProvidersTable(); updateStats();
        }
        window.deleteProviderFirebase = async function(id) { if(confirm('Delete?')) { await deleteDoc(doc(db, "serviceProviders", id)); loadProvidersTable(); updateStats(); } }
        window.deleteBookingFirebase = async function(id) { if(confirm('Delete?')) { await deleteDoc(doc(db, "bookings", id)); loadBookingsTable(); updateStats(); } }

        // --- MODAL & MISC LOGIC ---
        function handleLogout() { localStorage.clear(); location.reload(); }
        function handleProviderLogout() { handleLogout(); }
        
        function showLoginModal() { document.getElementById('loginModal').style.display='flex'; }
        function showSignupModal() { document.getElementById('loginModal').style.display='none'; document.getElementById('signupModal').style.display='flex'; }
        function closeAuthModal() { document.getElementById('loginModal').style.display='none'; document.getElementById('signupModal').style.display='none'; }
        function closeProviderModal() { document.getElementById('providerSelectionModal').style.display='none'; }
        function closeProviderRegistrationModal() { document.getElementById('providerRegistrationModal').style.display='none'; }
        function closeBookingDetailsModal() { document.getElementById('bookingDetailsModal').style.display='none'; }
        function closeResponseModal() { document.getElementById('responseModal').style.display='none'; }
        function closeSubmissionModal() { document.getElementById('submissionModal').style.display='none'; }

        function showHome() { hideAllPages(); document.getElementById('homeContent').style.display='block'; toggleFooter(true); updateUserInterface(); }
        function showServiceProvidersPage() { hideAllPages(); document.getElementById('serviceProvidersSection').style.display='block'; toggleFooter(true); loadAvailableProviders(); }
        function showContact() { hideAllPages(); document.getElementById('contactPage').style.display='block'; toggleFooter(true); }
        function showDashboard() { 
            const u = JSON.parse(localStorage.getItem('currentUser'));
            if(!u) { showLoginModal(); return; }
            hideAllPages(); document.getElementById('userDashboard').style.display='block'; toggleFooter(true); loadPersonalInfoForm(u); loadUserBookings(); 
        }
        function showProviderDashboard() { 
            const p = JSON.parse(localStorage.getItem('currentProvider'));
            if(!p) { showLoginModal(); return; }
            hideAllPages(); document.getElementById('providerDashboard').style.display='block'; toggleFooter(true); loadProviderDashboard(p);
        }
        function showAdminPanel() { 
            const u = JSON.parse(localStorage.getItem('currentUser'));
            if(!u || u.role !== 'admin') { alert('Access Denied'); return; }
            hideAllPages(); document.getElementById('adminPanel').style.display='block'; toggleFooter(false);
            updateStats(); loadUsersTable(); loadProvidersTable(); loadBookingsTable(); loadNewsTable(); loadSubmissionsTable();
        }

        async function deleteUser(id) { if(confirm('Delete?')) { await deleteDoc(doc(db, "users", id)); loadUsersTable(); updateStats(); } }
        async function deleteSubmission(id) { if(confirm('Delete?')) { await deleteDoc(doc(db, "submissions", id)); loadSubmissionsTable(); updateStats(); } }
        async function deleteNews(id) { if(confirm('Delete?')) { await deleteDoc(doc(db, "news", id)); loadNewsTable(); } }
        
        async function addNewsItem(event) {
            event.preventDefault();
            await addDoc(collection(db, "news"), {
                title: document.getElementById('newsTitle').value,
                category: document.getElementById('newsCategory').value,
                content: document.getElementById('newsContent').value,
                image: document.getElementById('newsImage').value,
                date: new Date().toISOString().split('T')[0]
            });
            document.getElementById('newsForm').reset();
            loadNewsTable();
            alert("News Added");
        }

        // --- VIEW BOOKING (Populate Modal) ---
        window.viewUserBooking = async function(id) {
            // Simplified logic: Re-fetch or pass data. Fetching for consistency.
            const snap = await getDoc(doc(db, "bookings", id));
            if(snap.exists()) {
                const b = snap.data();
                document.getElementById('bookingDetailsContent').innerHTML = `
                    <p><strong>Service:</strong> ${b.type}</p>
                    <p><strong>Provider:</strong> ${b.providerName}</p>
                    <p><strong>Date:</strong> ${b.preferredDate || b.bookingDate}</p>
                    <p><strong>Status:</strong> ${b.status}</p>
                    <p><strong>Notes:</strong> ${b.notes || b.projectDetails || 'None'}</p>
                `;
                document.getElementById('bookingDetailsModal').style.display='flex';
                // Provider Logic in modal
                const p = JSON.parse(localStorage.getItem('currentProvider'));
                const respDiv = document.getElementById('responseSection');
                if(p && b.providerId === p.id) {
                    respDiv.style.display = 'block';
                    document.getElementById('responseFormContainer').dataset.bookingId = id;
                } else {
                    respDiv.style.display = 'none';
                }
            }
        };
        window.viewProviderBooking = window.viewUserBooking; // Same modal

        window.submitProviderResponse = async function() {
            const bid = document.getElementById('responseFormContainer').dataset.bookingId;
            const txt = document.getElementById('providerResponse').value;
            await updateDoc(doc(db, "bookings", bid), { providerResponse: txt, status: 'confirmed', responseDate: new Date().toISOString().split('T')[0] });
            alert("Responded!"); closeBookingDetailsModal(); 
            // Reload provider tables
            const p = JSON.parse(localStorage.getItem('currentProvider'));
            if(p) loadProviderBookings(p.id);
        };

        window.markBookingAsCompleted = async function() {
            const bid = document.getElementById('responseFormContainer').dataset.bookingId;
            await updateDoc(doc(db, "bookings", bid), { status: 'completed' });
            alert("Completed!"); closeBookingDetailsModal();
            const p = JSON.parse(localStorage.getItem('currentProvider'));
            if(p) loadProviderBookings(p.id);
        };

        window.bookDoctorWithId = function(id) { document.getElementById('bookingDoctor').value = id; bookDoctor(); };
        window.bookDraftsmanWithId = function(id) { document.getElementById('bookingDraftsman').value = id; bookDraftsman(); };
        window.bookDoctor = function() { 
            if(!localStorage.getItem('currentUser')) { showLoginModal(); return; }
            document.getElementById('availableDoctors').style.display='none';
            document.getElementById('doctorBookingForm').style.display='block';
            document.getElementById('patientName').value = JSON.parse(localStorage.getItem('currentUser')).name;
        };
        window.bookDraftsman = function() {
            if(!localStorage.getItem('currentUser')) { showLoginModal(); return; }
            document.getElementById('availableDraftsmen').style.display='none';
            document.getElementById('draftsmanBookingForm').style.display='block';
            document.getElementById('clientName').value = JSON.parse(localStorage.getItem('currentUser')).name;
        };
        window.cancelBooking = function() {
            document.getElementById('doctorBookingForm').style.display='none';
            document.getElementById('draftsmanBookingForm').style.display='none';
            document.getElementById('availableDoctors').style.display='block';
            document.getElementById('availableDraftsmen').style.display='block';
        };

        window.switchAdminSection = function(id) {
            document.querySelectorAll('.admin-section').forEach(s => s.classList.remove('active'));
            document.getElementById('admin-'+id).classList.add('active');
        };
        window.switchProviderTab = function(tab) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.provider-tab').forEach(t => t.classList.remove('active'));
            document.getElementById('provider'+tab.charAt(0).toUpperCase()+tab.slice(1)+'Tab').classList.add('active');
            event.currentTarget.classList.add('active');
        };

        // --- INIT ---
        window.onload = function() {
            const lang = localStorage.getItem('preferredLanguage') || 'en';
            changeLanguage(lang);
            updateUserInterface();
            showHome();
            loadNewsTable(); // Preload news
        };

    </script>

</body>
</html>

